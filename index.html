<!DOCTYPE html><html lang="zh-TW"><head><meta name="x-poe-datastore-behavior" content="local_only"><meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://code.jquery.com https://unpkg.com https://d3js.org https://threejs.org https://cdn.plot.ly https://stackpath.bootstrapcdn.com https://maps.googleapis.com https://cdn.tailwindcss.com https://ajax.googleapis.com https://kit.fontawesome.com https://cdn.datatables.net https://maxcdn.bootstrapcdn.com https://code.highcharts.com https://tako-static-assets-production.s3.amazonaws.com https://www.youtube.com https://fonts.googleapis.com https://fonts.gstatic.com https://pfst.cf2.poecdn.net https://puc.poecdn.net https://i.imgur.com https://wikimedia.org https://*.icons8.com https://*.giphy.com https://picsum.photos https://images.unsplash.com; frame-src 'self' https://www.youtube.com https://trytako.com; child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–‡åŒ–å‚³æ‰¿å­¸é™¢ - éç‰©è³ªæ–‡åŒ–éºç”¢å­¸ç¿’å¹³å°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE',
                        'heritage-gold': '#D4AF37',
                        'heritage-red': '#DC143C'
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Noto Sans TC', sans-serif;
        }
        
        .bounce-in {
            animation: bounceIn 0.6s ease-out;
        }
        
        @keyframes bounceIn {
            0% { transform: scale(0.3); opacity: 0; }
            50% { transform: scale(1.05); }
            70% { transform: scale(0.9); }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .slide-up {
            animation: slideUp 0.5s ease-out;
        }
        
        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .progress-bar {
            background: linear-gradient(90deg, #5D5CDE 0%, #8B5CF6 100%);
        }
        
        .certificate-bg {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border: 8px solid #D4AF37;
        }
        
        .dark .certificate-bg {
            background: linear-gradient(135deg, #374151 0%, #4b5563 100%);
        }
    </style>
<script src="https://puc.poecdn.net/authenticated_preview_page/syncedState.3f7572448765332f3047.js"></script></head>
<body class="bg-white dark:bg-gray-900 text-gray-900 dark:text-white transition-colors duration-300">
    <!-- ä¸»å®¹å™¨ -->
    <div class="min-h-screen">
        <!-- å°èˆªæ¬„ -->
        <nav class="bg-primary text-white p-4 shadow-lg">
            <div class="max-w-4xl mx-auto flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-heritage-gold rounded-full flex items-center justify-center">
                        ğŸ›ï¸
                    </div>
                    <h1 class="text-xl font-bold">æ–‡åŒ–å‚³æ‰¿å­¸é™¢</h1>
                </div>
                <div class="flex items-center space-x-4">
                    <button onclick="showMarketplace()" class="text-white hover:text-heritage-gold transition-colors duration-300 flex items-center space-x-1">
                        <span>ğŸ›’</span>
                        <span class="hidden md:inline">å·¥è—å¸‚é›†</span>
                    </button>
                    <div class="flex items-center space-x-2">
                        <span class="text-heritage-gold">ğŸ”¥</span>
                        <span id="streak">0</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <span class="text-yellow-300">ğŸ’</span>
                        <span id="score">0</span>
                    </div>
                </div>
            </div>
        </nav>

        <!-- ä¸»è¦å…§å®¹ -->
        <main class="max-w-4xl mx-auto p-4">
            <!-- æ­¡è¿ç•«é¢ -->
            <div id="welcomeScreen" class="text-center py-12">
                <div class="bounce-in">
                    <div class="w-32 h-32 mx-auto mb-6 bg-gradient-to-br from-primary to-purple-600 rounded-full flex items-center justify-center text-6xl">
                        ğŸ­
                    </div>
                    <h2 class="text-3xl font-bold mb-4">æ­¡è¿ä¾†åˆ°æ–‡åŒ–å‚³æ‰¿å­¸é™¢</h2>
                    <p class="text-lg text-gray-600 dark:text-gray-300 mb-8 max-w-2xl mx-auto">
                        é€éäº’å‹•å¼å­¸ç¿’æ¢ç´¢ä¸–ç•Œå„åœ°çš„éç‰©è³ªæ–‡åŒ–éºç”¢ï¼Œå¾å‚³çµ±æŠ€è—åˆ°æ°‘ä¿—è¡¨æ¼”ï¼Œè®“æ–‡åŒ–åœ¨éŠæˆ²ä¸­å‚³æ‰¿ï¼
                    </p>
                    <button onclick="startLearning()" class="bg-primary hover:bg-purple-700 text-white px-8 py-4 rounded-full text-lg font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg">
                        é–‹å§‹å­¸ç¿’ä¹‹æ—… ğŸš€
                    </button>
                </div>
            </div>

            <!-- èª²ç¨‹é¸æ“‡ç•«é¢ -->
            <div id="courseScreen" class="hidden">
                <div class="mb-8">
                    <h2 class="text-2xl font-bold mb-4">é¸æ“‡å­¸ç¿’è·¯å¾‘</h2>
                    <div class="bg-gray-100 dark:bg-gray-800 rounded-full h-4 mb-6">
                        <div id="overallProgress" class="progress-bar h-full rounded-full transition-all duration-500" style="width: 0%"></div>
                    </div>
                </div>

                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6" id="courseList">
                    <!-- èª²ç¨‹å¡ç‰‡å°‡ç”±JavaScriptç”Ÿæˆ -->
                </div>

                <div class="mt-8 text-center" id="certificateSection" style="display: none;">
                    <div class="bg-heritage-gold bg-opacity-20 rounded-lg p-6 mb-4">
                        <h3 class="text-xl font-bold mb-2">ğŸ‰ æ­å–œæ‚¨å®Œæˆæ‰€æœ‰èª²ç¨‹ï¼</h3>
                        <p class="text-gray-600 dark:text-gray-300 mb-4">æ‚¨å·²ç¶“æŒæ¡äº†è±å¯Œçš„éç‰©è³ªæ–‡åŒ–éºç”¢çŸ¥è­˜</p>
                        <button onclick="showNameInputDialog(generateCertificateWithName)" class="bg-heritage-gold hover:bg-yellow-600 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-300">
                            ä¸‹è¼‰ç•¢æ¥­è­‰æ›¸ ğŸ“œ
                        </button>
                    </div>
                </div>
            </div>

            <!-- å­¸ç¿’ç•«é¢ -->
            <div id="learningScreen" class="hidden">
                <div class="mb-6">
                    <div class="flex items-center justify-between mb-4">
                        <button onclick="backToCourses()" class="text-primary hover:text-purple-700 flex items-center space-x-2">
                            <span>â†</span>
                            <span>è¿”å›èª²ç¨‹</span>
                        </button>
                        <div class="flex items-center space-x-4">
                            <div class="flex items-center space-x-2">
                                <span>â¤ï¸</span>
                                <span id="lives">3</span>
                            </div>
                            <div id="questionProgress" class="text-sm text-gray-600 dark:text-gray-300"></div>
                        </div>
                    </div>
                    <div class="bg-gray-200 dark:bg-gray-700 rounded-full h-3">
                        <div id="progressBar" class="progress-bar h-full rounded-full transition-all duration-300" style="width: 0%"></div>
                    </div>
                </div>

                <div id="questionContainer" class="slide-up">
                    <!-- å•é¡Œå…§å®¹å°‡ç”±JavaScriptç”Ÿæˆ -->
                </div>

                <div id="feedback" class="hidden mt-6 p-4 rounded-lg text-center">
                    <div id="feedbackContent"></div>
                    <button id="nextButton" onclick="nextQuestion()" class="mt-4 bg-primary hover:bg-purple-700 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-300">
                        ç¹¼çºŒ
                    </button>
                </div>
            </div>

            <!-- èª²ç¨‹å®Œæˆç•«é¢ -->
            <div id="completionScreen" class="hidden text-center py-12">
                <div class="bounce-in">
                    <div class="w-24 h-24 mx-auto mb-6 bg-green-500 rounded-full flex items-center justify-center text-4xl">
                        âœ¨
                    </div>
                    <h2 class="text-3xl font-bold mb-4">èª²ç¨‹å®Œæˆï¼</h2>
                    <p class="text-lg text-gray-600 dark:text-gray-300 mb-6">
                        æ­å–œæ‚¨å®Œæˆäº† <span id="completedCourseName" class="font-semibold text-primary"></span> èª²ç¨‹
                    </p>
                    <div class="mb-8">
                        <div class="text-2xl font-bold text-heritage-gold mb-2">+<span id="earnedScore">100</span> ğŸ’</div>
                        <div class="text-lg">é€£çºŒå­¸ç¿’ <span id="currentStreak" class="font-semibold">1</span> å¤© ğŸ”¥</div>
                    </div>
                    
                    <!-- èª²ç¨‹è­‰æ›¸ä¸‹è¼‰ -->
                    <div class="bg-heritage-gold bg-opacity-20 rounded-lg p-6 mb-6 max-w-md mx-auto">
                        <h3 class="text-lg font-bold mb-3">ğŸ“ æ‚¨å·²ç²å¾—èª²ç¨‹è­‰æ›¸ï¼</h3>
                        <button onclick="showNameInputDialog(generateCourseCertificateWithName)" class="bg-heritage-gold hover:bg-yellow-600 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-300 mb-3">
                            ä¸‹è¼‰ <span id="certificateCourseName"></span> è­‰æ›¸ ğŸ“œ
                        </button>
                        <p class="text-sm text-gray-600 dark:text-gray-400">
                            è­‰æ›¸å°‡åŒ…å«æ‚¨åœ¨æ­¤èª²ç¨‹ä¸­çš„å­¸ç¿’æˆæœ
                        </p>
                    </div>
                    
                    <!-- å¸«çˆ¶æ¨è–¦å€åŸŸ -->
                    <div class="bg-gradient-to-r from-purple-100 to-pink-100 dark:from-purple-900 dark:to-pink-900 rounded-lg p-6 mb-6 max-w-2xl mx-auto">
                        <h3 class="text-xl font-bold mb-4 text-center">ğŸ¯ å°‹æ‰¾æ‚¨çš„å°ˆå±¬å¸«çˆ¶</h3>
                        <p class="text-gray-700 dark:text-gray-300 mb-4 text-center">
                            æº–å‚™å¥½æ·±å…¥å­¸ç¿’äº†å—ï¼Ÿæˆ‘å€‘ç‚ºæ‚¨æ¨è–¦åœ¨æ­¤é ˜åŸŸç¶“é©—è±å¯Œçš„å¸«çˆ¶ï¼Œé–‹å§‹æ‚¨çš„é€²ä¿®ä¹‹æ—…ï¼
                        </p>
                        <button onclick="showMasterRecommendations()" class="w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-300 transform hover:scale-105">
                            ğŸ§‘â€ğŸ« æ¢ç´¢å¸«çˆ¶é…å°
                        </button>
                    </div>
                    
                    <button onclick="backToCourses()" class="bg-primary hover:bg-purple-700 text-white px-8 py-4 rounded-full text-lg font-semibold transition-all duration-300">
                        ç¹¼çºŒå­¸ç¿’
                    </button>
                </div>
            </div>
        </main>
    </div>

    <!-- è‡ªå®šç¾©æ¨¡æ…‹æ¡† -->
    <div id="customModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg max-w-md w-full mx-4">
            <div id="modalContent"></div>
        </div>
    </div>

    <script>
        // æš—è‰²æ¨¡å¼è¨­ç½®
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

        // å­¸ç¿’æ•¸æ“š
        let userProgress = {
            score: 0,
            streak: 1,
            lives: 3,
            completedCourses: [],
            currentCourse: null,
            currentQuestion: 0,
            userName: '' // å„²å­˜ç”¨æˆ¶å§“å
        };

        // å¸«çˆ¶è³‡æ–™åº«
        const masters = {
            'traditional-crafts': [
                {
                    id: 'master-craft-1',
                    name: 'ææ™¯æ³°',
                    title: 'æ™¯æ³°è—å·¥è—å¤§å¸«',
                    experience: '45å¹´',
                    location: 'åŒ—äº¬',
                    specialties: ['æ™¯æ³°è—', 'éŠ…èƒæçµ²çºç‘¯', 'å‚³çµ±é‡‘å±¬å·¥è—'],
                    description: 'åœ‹å®¶ç´šéç‰©è³ªæ–‡åŒ–éºç”¢ä»£è¡¨æ€§å‚³æ‰¿äººï¼Œå¸«æ‰¿æ™¯æ³°è—ä¸–å®¶ï¼Œä½œå“å¤šæ¬¡åœ¨åœ‹éš›å±•è¦½ä¸­ç²çã€‚æ“…é•·å‚³çµ±èˆ‡ç¾ä»£çµåˆçš„å‰µæ–°æŠ€æ³•ã€‚',
                    contact: 'lijingtai@heritage.cn',
                    achievements: ['åœ‹å®¶å·¥è—ç¾è¡“å¤§å¸«', 'è¯åˆåœ‹æ•™ç§‘æ–‡çµ„ç¹”å·¥è—èˆ‡æ°‘é–“è—è¡“å¤§å¸«', 'ä¸­åœ‹å·¥è—ç¾è¡“çµ‚èº«æˆå°±ç'],
                    teachingStyle: 'æ³¨é‡åŸºç¤åŠŸåº•åŸ¹é¤Šï¼Œå¼·èª¿æ‰‹å·¥æŠ€è—çš„ç²¾æº–æ€§ï¼Œæ¡ç”¨ä¸€å°ä¸€æŒ‡å°æ–¹å¼'
                },
                {
                    id: 'master-craft-2',
                    name: 'ç”°ä¸­ç¾æ™ºå­',
                    title: 'æ—¥æœ¬æŠ˜ç´™è—è¡“å®¶',
                    experience: '30å¹´',
                    location: 'æ±äº¬',
                    specialties: ['å‚³çµ±æŠ˜ç´™', 'å‰µæ„æŠ˜ç´™', 'æŠ˜ç´™é›•å¡‘'],
                    description: 'æ—¥æœ¬æŠ˜ç´™å”æœƒèªè­‰è¬›å¸«ï¼Œå°ˆç²¾è¤‡é›œå¹¾ä½•æŠ˜ç´™å’Œå‹•æ¤ç‰©é€ å‹ï¼Œæ•™å­¸ç¶“é©—è±å¯Œã€‚',
                    contact: 'tanaka.michiko@origami.jp',
                    achievements: ['æ—¥æœ¬æŠ˜ç´™å”æœƒæœ€é«˜æ¦®è­½ç', 'åœ‹éš›æŠ˜ç´™å¥§æ—åŒ¹å…‹é‡‘ç', 'æ—¥æœ¬æ–‡åŒ–å»³é•·å®˜è¡¨å½°'],
                    teachingStyle: 'å¾ªåºæ¼¸é€²æ•™å­¸æ³•ï¼Œå¾ç°¡å–®åŸºç¤é–‹å§‹ï¼ŒåŸ¹é¤Šå­¸ç”Ÿç©ºé–“æ€ç¶­å’Œå‰µé€ åŠ›'
                }
            ],
            'folk-music': [
                {
                    id: 'master-music-1',
                    name: 'ç‹å¤ç´',
                    title: 'å¤ç´æ¼”å¥å®¶',
                    experience: '38å¹´',
                    location: 'è˜‡å·',
                    specialties: ['å¤ç´æ¼”å¥', 'å¤å…¸éŸ³æ¨‚ç†è«–', 'ç´æ­Œæ¼”å”±'],
                    description: 'ä¸­åœ‹å¤ç´å­¸æœƒç†äº‹ï¼Œå¸«æ‰¿å»£é™µæ´¾ï¼Œç²¾é€šå¤šç¨®å¤ç´æµæ´¾æŠ€æ³•ï¼Œè‡´åŠ›æ–¼å¤ç´æ–‡åŒ–çš„å‚³æ‰¿èˆ‡æ¨å»£ã€‚',
                    contact: 'wang.guqin@classical.cn',
                    achievements: ['ä¸­åœ‹æ°‘æ—éŸ³æ¨‚æœ€é«˜ç', 'å¤ç´è—è¡“çµ‚èº«æˆå°±ç', 'è¯åˆåœ‹å’Œå¹³è—è¡“å®¶'],
                    teachingStyle: 'æ³¨é‡éŸ³æ¨‚å…§æ¶µå’Œæ–‡åŒ–åº•è˜Šï¼Œçµåˆå¤è©©è©æ•™å­¸ï¼ŒåŸ¹é¤Šå­¸ç”Ÿçš„è—è¡“ä¿®é¤Š'
                },
                {
                    id: 'master-music-2',
                    name: 'SeÃ¡n Ã“ Riada',
                    title: 'æ„›çˆ¾è˜­å‚³çµ±éŸ³æ¨‚å¤§å¸«',
                    experience: '42å¹´',
                    location: 'éƒ½æŸæ—',
                    specialties: ['æ„›çˆ¾è˜­èˆæ›²', 'å‚³çµ±æ¨‚å™¨æ¼”å¥', 'æ°‘æ—éŸ³æ¨‚ç·¨æ›²'],
                    description: 'æ„›çˆ¾è˜­åœ‹å®¶éŸ³æ¨‚å­¸é™¢æ•™æˆï¼Œè‡´åŠ›æ–¼ä¿è­·å’Œç™¼å±•æ„›çˆ¾è˜­å‚³çµ±éŸ³æ¨‚ï¼ŒåŸ¹é¤Šäº†çœ¾å¤šå„ªç§€éŸ³æ¨‚å®¶ã€‚',
                    contact: 'sean.oriada@irish-music.ie',
                    achievements: ['æ„›çˆ¾è˜­æ–‡åŒ–éºç”¢ç', 'æ­æ´²æ°‘æ—éŸ³æ¨‚è²¢ç»ç', 'åœ‹éš›å‡±çˆ¾ç‰¹éŸ³æ¨‚ç¯€çµ‚èº«æˆå°±ç'],
                    teachingStyle: 'é‡è¦–å¯¦è¸æ¼”å¥ï¼Œé¼“å‹µå­¸ç”Ÿåƒèˆ‡å‚³çµ±éŸ³æ¨‚æœƒï¼Œåœ¨å¯¦è¸ä¸­å­¸ç¿’å’Œå‚³æ‰¿'
                }
            ],
            'festivals': [
                {
                    id: 'master-festival-1',
                    name: 'é™³æ…¶æ˜¥',
                    title: 'æ˜¥ç¯€æ°‘ä¿—å°ˆå®¶',
                    experience: '35å¹´',
                    location: 'ç¦å»º',
                    specialties: ['æ˜¥ç¯€ç¿’ä¿—', 'å‰ªç´™è—è¡“', 'æ°‘é–“æ•…äº‹'],
                    description: 'æ°‘ä¿—å­¸åšå£«ï¼Œå°ˆç ”ä¸­åœ‹å‚³çµ±ç¯€æ…¶æ–‡åŒ–ï¼Œåƒèˆ‡å¤šé …åœ‹å®¶ç´šæ–‡åŒ–ä¿è­·é …ç›®ï¼Œè‘—æœ‰ã€Šä¸­è¯ç¯€æ…¶æ–‡åŒ–å¤§å…¨ã€‹ã€‚',
                    contact: 'chen.qingchun@folklore.cn',
                    achievements: ['ä¸­åœ‹æ°‘ä¿—å­¸æœƒçµ‚èº«æœƒå“¡', 'åœ‹å®¶ç¤¾ç§‘åŸºé‡‘é‡å¤§é …ç›®ä¸»æŒäºº', 'æ–‡åŒ–éƒ¨ééºä¿è­·å…ˆé€²å€‹äºº'],
                    teachingStyle: 'ç†è«–èˆ‡å¯¦è¸çµåˆï¼Œå¸¶é ˜å­¸ç”Ÿåƒèˆ‡å¯¦åœ°èª¿ç ”å’Œç¯€æ…¶æ´»å‹•ç­–åŠƒ'
                },
                {
                    id: 'master-festival-2',
                    name: 'Rajesh Holi',
                    title: 'å°åº¦è‰²å½©ç¯€å‚³æ‰¿äºº',
                    experience: '28å¹´',
                    location: 'æ–°å¾·é‡Œ',
                    specialties: ['å°åº¦ç¯€æ…¶', 'å‚³çµ±èˆè¹ˆ', 'å®—æ•™å„€å¼'],
                    description: 'å°åº¦æ–‡åŒ–éƒ¨èªè­‰çš„å‚³çµ±ç¯€æ…¶å°ˆå®¶ï¼Œè‡´åŠ›æ–¼å‘ä¸–ç•Œæ¨å»£å°åº¦è±å¯Œçš„ç¯€æ…¶æ–‡åŒ–ï¼Œç¶“å¸¸å—é‚€åˆ°å„åœ‹é€²è¡Œæ–‡åŒ–äº¤æµã€‚',
                    contact: 'rajesh.holi@indian-culture.in',
                    achievements: ['å°åº¦æ–‡åŒ–å¤§ä½¿', 'åœ‹éš›æ–‡åŒ–äº¤æµè²¢ç»ç', 'è¯åˆåœ‹æ–‡åŒ–å¤šæ¨£æ€§æ¨å»£ä½¿è€…'],
                    teachingStyle: 'æ³¨é‡æ–‡åŒ–èƒŒæ™¯ä»‹ç´¹ï¼Œé€éè¦ªèº«é«”é©—è®“å­¸ç”Ÿç†è§£ç¯€æ…¶çš„æ·±å±¤æ„ç¾©'
                }
            ],
            'culinary-arts': [
                {
                    id: 'master-culinary-1',
                    name: 'Pierre Dubois',
                    title: 'æ³•å¼æ–™ç†å¤§å¸«',
                    experience: '40å¹´',
                    location: 'å·´é»',
                    specialties: ['ç¶“å…¸æ³•å¼æ–™ç†', 'é†¬æ–™è£½ä½œ', 'çƒ¹é£ªæŠ€æ³•'],
                    description: 'ç±³å…¶æ—ä¸‰æ˜Ÿä¸»å»šï¼Œæ³•åœ‹å»šå¸«å”æœƒæ¦®è­½æœƒå“¡ï¼Œè‡´åŠ›æ–¼å‚³æ‰¿æ³•å¼æ–™ç†çš„ç²¾é«“ï¼ŒåŸ¹é¤Šæ–°ä¸€ä»£å»šå¸«äººæ‰ã€‚',
                    contact: 'pierre.dubois@cuisine-francaise.fr',
                    achievements: ['æ³•åœ‹æ¦®è­½è»åœ˜å‹³ç« ', 'åœ‹éš›çƒ¹é£ªå¤§å¸«è³½å† è»', 'æ³•å¼æ–™ç†æ–‡åŒ–å¤§ä½¿'],
                    teachingStyle: 'åš´æ ¼è¦æ±‚åŸºæœ¬åŠŸï¼Œæ³¨é‡é£Ÿæé¸æ“‡å’Œè™•ç†æŠ€å·§ï¼ŒåŸ¹é¤Šå­¸ç”Ÿçš„å‘³è¦ºæ•æ„Ÿåº¦'
                },
                {
                    id: 'master-culinary-2',
                    name: 'ç”°ä¸­ä¸€éƒ',
                    title: 'æ‡·çŸ³æ–™ç†åå¸«',
                    experience: '33å¹´',
                    location: 'äº¬éƒ½',
                    specialties: ['æ‡·çŸ³æ–™ç†', 'èŒ¶é“', 'å­£ç¯€æ–™ç†'],
                    description: 'äº¬éƒ½è€èˆ–æ–™äº­ç¬¬ä¸‰ä»£å‚³äººï¼Œæ—¥æœ¬æ–™ç†å”æœƒç†äº‹ï¼Œå°‡å­£ç¯€ç¾å­¸èˆ‡æ–™ç†è—è¡“å®Œç¾çµåˆã€‚',
                    contact: 'tanaka.ichiro@kaiseki.jp',
                    achievements: ['æ—¥æœ¬æ–™ç†æ–‡åŒ–åŠŸå‹è€…', 'äº¬éƒ½æ–‡åŒ–è²¡ä¿è­·è²¢ç»è³', 'åœ‹éš›å’Œé£Ÿæ¨å»£å¤§ä½¿'],
                    teachingStyle: 'é‡è¦–å­£ç¯€æ„Ÿå’Œç¾å­¸è¡¨ç¾ï¼Œæ•™å°å­¸ç”Ÿç”¨å¿ƒæ„Ÿå—è‡ªç„¶èˆ‡é£Ÿæçš„å’Œè«§'
                }
            ],
            'storytelling': [
                {
                    id: 'master-story-1',
                    name: 'Hans MÃ¼ller',
                    title: 'æ ¼æ—ç«¥è©±ç ”ç©¶å°ˆå®¶',
                    experience: '32å¹´',
                    location: 'æ³•è˜­å…‹ç¦',
                    specialties: ['å¾·åœ‹æ°‘é–“æ•…äº‹', 'ç«¥è©±ç ”ç©¶', 'å£è¿°å‚³çµ±'],
                    description: 'å¾·åœ‹æ°‘é–“æ–‡å­¸å­¸æœƒä¸»å¸­ï¼Œæ ¼æ—å…„å¼Ÿç ”ç©¶æ‰€æ‰€é•·ï¼Œè‡´åŠ›æ–¼å¾·åœ‹æ°‘é–“æ•…äº‹çš„æ”¶é›†ã€æ•´ç†å’Œå‚³æ’­ã€‚',
                    contact: 'hans.muller@grimm-institute.de',
                    achievements: ['å¾·åœ‹æ–‡å­¸è²¢ç»ç', 'æ­æ´²æ°‘é–“æ–‡å­¸ç ”ç©¶å‚‘å‡ºæˆå°±ç', 'è¯åˆåœ‹æ•™ç§‘æ–‡çµ„ç¹”æ–‡åŒ–éºç”¢ä¿è­·å°ˆå®¶'],
                    teachingStyle: 'æ³¨é‡æ•…äº‹çš„æ–‡åŒ–å…§æ¶µå’Œæ•™è‚²æ„ç¾©ï¼ŒåŸ¹é¤Šå­¸ç”Ÿçš„æ•˜äº‹æŠ€å·§å’Œè¡¨é”èƒ½åŠ›'
                },
                {
                    id: 'master-story-2',
                    name: 'åŠ‰å¿—æ°‘',
                    title: 'ä¸­åœ‹æ°‘é–“æ•…äº‹å‚³æ‰¿äºº',
                    experience: '45å¹´',
                    location: 'å±±è¥¿',
                    specialties: ['ä¸­åœ‹ç¥è©±å‚³èªª', 'è©•æ›¸è—è¡“', 'æ–¹è¨€æ•…äº‹'],
                    description: 'åœ‹å®¶ç´šéç‰©è³ªæ–‡åŒ–éºç”¢ä»£è¡¨æ€§å‚³æ‰¿äººï¼Œç²¾é€šå„åœ°æ–¹è¨€èªªæ›¸æŠ€è—ï¼Œæœƒè¬›åƒé¤˜å€‹å‚³çµ±æ•…äº‹ã€‚',
                    contact: 'liu.zhimin@stories.cn',
                    achievements: ['ä¸­åœ‹æ›²è—ç‰¡ä¸¹ççµ‚èº«æˆå°±ç', 'åœ‹å®¶ééºå‚³æ‰¿äºº', 'ä¸­åœ‹æ°‘é–“æ–‡è—æœ€é«˜ç'],
                    teachingStyle: 'å£å‚³å¿ƒæˆï¼Œæ³¨é‡èªè¨€éŸ»å¾‹å’Œè¡¨æ¼”æŠ€å·§ï¼ŒåŸ¹é¤Šå­¸ç”Ÿçš„è¨˜æ†¶åŠ›å’Œè¡¨ç¾åŠ›'
                }
            ],
            'martial-arts': [
                {
                    id: 'master-martial-1',
                    name: 'é™³å¤ªæ¥µ',
                    title: 'å¤ªæ¥µæ‹³å®—å¸«',
                    experience: '50å¹´',
                    location: 'æ²³å—æº«ç¸£',
                    specialties: ['é™³å¼å¤ªæ¥µæ‹³', 'å¤ªæ¥µç†è«–', 'å…§åŠŸä¿®ç…‰'],
                    description: 'é™³å¼å¤ªæ¥µæ‹³ç¬¬åä¹ä»£å‚³äººï¼Œåœ‹éš›å¤ªæ¥µæ‹³è¯åˆæœƒä¸»å¸­ï¼Œå°‡å¤ªæ¥µæ‹³æ¨å»£åˆ°ä¸–ç•Œå„åœ°ã€‚',
                    contact: 'chen.taiji@taichi.cn',
                    achievements: ['å¤ªæ¥µæ‹³çµ‚èº«æˆå°±ç', 'åœ‹éš›æ­¦è¡“æ®¿å ‚æˆå“¡', 'ä¸–ç•Œå¤ªæ¥µæ‹³å† è»è³½ç¸½è£åˆ¤é•·'],
                    teachingStyle: 'æ³¨é‡å…§å¤–å…¼ä¿®ï¼Œå¼·èª¿ç†è«–èˆ‡å¯¦è¸çµåˆï¼Œå› ææ–½æ•™å¾ªåºæ¼¸é€²'
                },
                {
                    id: 'master-martial-2',
                    name: 'å±±ç”°ç©ºæ‰‹',
                    title: 'ç©ºæ‰‹é“å¸«ç¯„',
                    experience: '35å¹´',
                    location: 'æ²–ç¹©',
                    specialties: ['å‚³çµ±ç©ºæ‰‹é“', 'æ­¦è¡“å“²å­¸', 'èº«å¿ƒä¿®ç…‰'],
                    description: 'æ²–ç¹©ç©ºæ‰‹é“å”æœƒæœƒé•·ï¼Œè‡´åŠ›æ–¼ä¿æŒç©ºæ‰‹é“çš„å‚³çµ±ç²¾ç¥ï¼ŒåŸ¹é¤Šäº†çœ¾å¤šåœ‹éš›å† è»ã€‚',
                    contact: 'yamada.karate@okinawa.jp',
                    achievements: ['ç©ºæ‰‹é“åæ®µ', 'å…¨æ—¥æœ¬ç©ºæ‰‹é“é€£ç›Ÿåè­½æœƒé•·', 'åœ‹éš›ç©ºæ‰‹é“è¯ç›ŸæŠ€è¡“å§”å“¡'],
                    teachingStyle: 'é‡è¦–æ­¦å¾·ä¿®é¤Šå’Œç²¾ç¥é›ç…‰ï¼Œæ•™å°å­¸ç”Ÿæ­£ç¢ºçš„æ­¦è¡“æ…‹åº¦å’Œäººç”Ÿå“²å­¸'
                }
            ]
        };

        // èª²ç¨‹æ•¸æ“š
        const courses = [
            {
                id: 'traditional-crafts',
                title: 'å‚³çµ±æ‰‹å·¥è—',
                description: 'æ¢ç´¢ä¸–ç•Œå„åœ°çš„å‚³çµ±æ‰‹å·¥æŠ€è—',
                icon: 'ğŸº',
                color: 'bg-red-500',
                questions: [
                    {
                        type: 'multiple',
                        question: 'ä¸­åœ‹çš„æ™¯æ³°è—å·¥è—èµ·æºæ–¼å“ªå€‹æœä»£ï¼Ÿ',
                        options: ['æ˜æœ', 'å…ƒæœ', 'æ¸…æœ', 'å®‹æœ'],
                        correct: 1,
                        explanation: 'æ™¯æ³°è—åˆç¨±çºç‘¯ï¼Œèµ·æºæ–¼å…ƒæœï¼Œåœ¨æ˜æœæ™¯æ³°å¹´é–“é”åˆ°é¼ç››ï¼Œå› æ­¤å¾—åã€‚'
                    },
                    {
                        type: 'multiple',
                        question: 'æ—¥æœ¬çš„æŠ˜ç´™è—è¡“è¢«ç¨±ç‚ºä»€éº¼ï¼Ÿ',
                        options: ['Ikebana', 'Origami', 'Sumi-e', 'Bonsai'],
                        correct: 1,
                        explanation: 'Origamiï¼ˆæŠ˜ç´™ï¼‰æ˜¯æ—¥æœ¬çš„å‚³çµ±æ‘ºç´™è—è¡“ï¼Œé€šéæ‘ºç–Šç´™å¼µå‰µé€ å„ç¨®å½¢ç‹€ã€‚'
                    },
                    {
                        type: 'matching',
                        question: 'å°‡ä»¥ä¸‹å‚³çµ±å·¥è—èˆ‡å…¶åŸç”¢åœ°é…å°ï¼š',
                        pairs: [
                            { left: 'å¨å°¼æ–¯ç»ç’ƒ', right: 'æ„å¤§åˆ©' },
                            { left: 'æ³¢æ–¯åœ°æ¯¯', right: 'ä¼Šæœ—' },
                            { left: 'å°åº¦çµ²ç¶¢', right: 'å°åº¦' }
                        ],
                        explanation: 'é€™äº›éƒ½æ˜¯å„åœ°è‘—åçš„å‚³çµ±å·¥è—ï¼Œä»£è¡¨äº†ä¸åŒæ–‡åŒ–çš„ç²¾æ¹›æŠ€è—ã€‚'
                    }
                ]
            },
            {
                id: 'folk-music',
                title: 'æ°‘æ—éŸ³æ¨‚',
                description: 'è†è½ä¸–ç•Œå„åœ°çš„å‚³çµ±éŸ³æ¨‚æ–‡åŒ–',
                icon: 'ğŸµ',
                color: 'bg-blue-500',
                questions: [
                    {
                        type: 'multiple',
                        question: 'å¤ç´åœ¨ä¸­åœ‹éŸ³æ¨‚å²ä¸Šæœ‰å¤šå°‘å¹´çš„æ­·å²ï¼Ÿ',
                        options: ['1000å¹´', '2000å¹´', '3000å¹´', '4000å¹´'],
                        correct: 2,
                        explanation: 'å¤ç´æœ‰è‘—è¶…é3000å¹´çš„æ‚ ä¹…æ­·å²ï¼Œæ˜¯ä¸­åœ‹æœ€å¤è€çš„å½ˆæ’¥æ¨‚å™¨ä¹‹ä¸€ã€‚'
                    },
                    {
                        type: 'multiple',
                        question: 'æ„›çˆ¾è˜­çš„å‚³çµ±èˆè¹ˆè¢«ç¨±ç‚ºä»€éº¼ï¼Ÿ',
                        options: ['Flamenco', 'Irish Dance', 'Waltz', 'Tango'],
                        correct: 1,
                        explanation: 'Irish Danceï¼ˆæ„›çˆ¾è˜­èˆï¼‰æ˜¯æ„›çˆ¾è˜­çš„å‚³çµ±æ°‘æ—èˆè¹ˆï¼Œä»¥å…¶ç¨ç‰¹çš„è…³æ­¥æŠ€å·§èåã€‚'
                    },
                    {
                        type: 'matching',
                        question: 'å°‡ä»¥ä¸‹æ¨‚å™¨èˆ‡å…¶å°æ‡‰çš„æ–‡åŒ–é…å°ï¼š',
                        pairs: [
                            { left: 'è–©å…‹æ–¯ç®¡', right: 'çˆµå£«æ¨‚' },
                            { left: 'äºŒèƒ¡', right: 'ä¸­åœ‹æ°‘æ¨‚' },
                            { left: 'çƒå¾·ç´', right: 'é˜¿æ‹‰ä¼¯éŸ³æ¨‚' }
                        ],
                        explanation: 'æ¯ç¨®æ¨‚å™¨éƒ½æ‰¿è¼‰è‘—ç‰¹å®šæ–‡åŒ–çš„éŸ³æ¨‚å‚³çµ±å’Œæƒ…æ„Ÿè¡¨é”ã€‚'
                    }
                ]
            },
            {
                id: 'festivals',
                title: 'å‚³çµ±ç¯€æ…¶',
                description: 'äº†è§£ä¸–ç•Œå„åœ°çš„å‚³çµ±ç¯€æ—¥æ…¶å…¸',
                icon: 'ğŸŠ',
                color: 'bg-green-500',
                questions: [
                    {
                        type: 'multiple',
                        question: 'ä¸­åœ‹æ˜¥ç¯€æœŸé–“ï¼Œäººå€‘æœƒåœ¨é–€ä¸Šè²¼ä»€éº¼ä¾†ç¥ˆæ±‚å¥½é‹ï¼Ÿ',
                        options: ['æ˜¥è¯', 'å¹´ç•«', 'å‰ªç´™', 'ä»¥ä¸Šçš†æ˜¯'],
                        correct: 3,
                        explanation: 'æ˜¥ç¯€æœŸé–“ï¼Œä¸­åœ‹äººæœƒè²¼æ˜¥è¯ã€å¹´ç•«å’Œå‰ªç´™ç­‰è£é£¾å“ä¾†è¿æ¥æ–°å¹´ï¼Œç¥ˆæ±‚å¥½é‹ã€‚'
                    },
                    {
                        type: 'multiple',
                        question: 'å°åº¦çš„è‰²å½©ç¯€ï¼ˆHoliï¼‰ä¸»è¦æ…¶ç¥ä»€éº¼ï¼Ÿ',
                        options: ['è±æ”¶', 'æ˜¥å¤©åˆ°ä¾†', 'æ–°å¹´', 'æ„›æƒ…'],
                        correct: 1,
                        explanation: 'Holiï¼ˆè‰²å½©ç¯€ï¼‰æ˜¯å°åº¦æ…¶ç¥æ˜¥å¤©åˆ°ä¾†çš„ç¯€æ—¥ï¼Œäººå€‘æœƒäº’ç›¸æ’’å½©è‰²ç²‰æœ«æ…¶ç¥ã€‚'
                    },
                    {
                        type: 'matching',
                        question: 'å°‡ä»¥ä¸‹ç¯€æ—¥èˆ‡å…¶ç‰¹è‰²æ´»å‹•é…å°ï¼š',
                        pairs: [
                            { left: 'å·´è¥¿å˜‰å¹´è¯', right: 'æ¡‘å·´èˆ' },
                            { left: 'å¾·åœ‹å•¤é…’ç¯€', right: 'å–å•¤é…’' },
                            { left: 'æ—¥æœ¬æ«»èŠ±ç¥­', right: 'è³æ«»èŠ±' }
                        ],
                        explanation: 'æ¯å€‹ç¯€æ—¥éƒ½æœ‰å…¶ç¨ç‰¹çš„æ…¶ç¥æ–¹å¼ï¼Œé«”ç¾äº†ä¸åŒæ–‡åŒ–çš„ç‰¹è‰²ã€‚'
                    }
                ]
            },
            {
                id: 'culinary-arts',
                title: 'çƒ¹é£ªè—è¡“',
                description: 'å“å‘³ä¸–ç•Œå„åœ°çš„å‚³çµ±ç¾é£Ÿæ–‡åŒ–',
                icon: 'ğŸœ',
                color: 'bg-yellow-500',
                questions: [
                    {
                        type: 'multiple',
                        question: 'æ³•åœ‹æ–™ç†ä¸­çš„ã€Œäº”å¤§æ¯é†¬ã€ä¸åŒ…æ‹¬å“ªä¸€ç¨®ï¼Ÿ',
                        options: ['ç™½é†¬', 'æ£•é†¬', 'ç•ªèŒ„é†¬', 'å’–å“©é†¬'],
                        correct: 3,
                        explanation: 'æ³•å¼æ–™ç†çš„äº”å¤§æ¯é†¬åŒ…æ‹¬ç™½é†¬ã€æ£•é†¬ã€ç•ªèŒ„é†¬ã€è›‹é»ƒé†¬å’Œç™½å¥¶æ²¹é†¬ï¼Œä¸åŒ…æ‹¬å’–å“©é†¬ã€‚'
                    },
                    {
                        type: 'multiple',
                        question: 'æ—¥æœ¬çš„æ‡·çŸ³æ–™ç†å¼·èª¿ä»€éº¼ç†å¿µï¼Ÿ',
                        options: ['é‡å¤šå‘³ç¾', 'å­£ç¯€æ€§èˆ‡ç¾æ„Ÿ', 'å¿«é€Ÿè£½ä½œ', 'é¦™è¾£å£å‘³'],
                        correct: 1,
                        explanation: 'æ‡·çŸ³æ–™ç†å¼·èª¿å­£ç¯€æ€§é£Ÿæå’Œè¦–è¦ºç¾æ„Ÿï¼Œé«”ç¾äº†æ—¥æœ¬æ–™ç†çš„ç²¾ç·»æ–‡åŒ–ã€‚'
                    },
                    {
                        type: 'matching',
                        question: 'å°‡ä»¥ä¸‹å‚³çµ±é£Ÿç‰©èˆ‡å…¶åŸç”¢åœ°é…å°ï¼š',
                        pairs: [
                            { left: 'æ¯”è–©', right: 'æ„å¤§åˆ©' },
                            { left: 'å£½å¸', right: 'æ—¥æœ¬' },
                            { left: 'å¡”å¯', right: 'å¢¨è¥¿å“¥' }
                        ],
                        explanation: 'é€™äº›ç¾é£Ÿéƒ½æ˜¯å„åœ‹æ–‡åŒ–çš„é‡è¦çµ„æˆéƒ¨åˆ†ï¼Œæ‰¿è¼‰è‘—æ·±åšçš„æ­·å²å‚³çµ±ã€‚'
                    }
                ]
            },
            {
                id: 'storytelling',
                title: 'å£è¿°å‚³çµ±',
                description: 'è†è½ä¸–ç•Œå„åœ°çš„æ°‘é–“æ•…äº‹èˆ‡å‚³èªª',
                icon: 'ğŸ“š',
                color: 'bg-purple-500',
                questions: [
                    {
                        type: 'multiple',
                        question: 'ã€Šæ ¼æ—ç«¥è©±ã€‹æ”¶é›†äº†å“ªå€‹åœ‹å®¶çš„æ°‘é–“æ•…äº‹ï¼Ÿ',
                        options: ['æ³•åœ‹', 'å¾·åœ‹', 'è‹±åœ‹', 'ä¸¹éº¥'],
                        correct: 1,
                        explanation: 'ã€Šæ ¼æ—ç«¥è©±ã€‹æ˜¯ç”±å¾·åœ‹çš„æ ¼æ—å…„å¼Ÿæ”¶é›†æ•´ç†çš„å¾·åœ‹æ°‘é–“æ•…äº‹é›†ã€‚'
                    },
                    {
                        type: 'multiple',
                        question: 'ä¸­åœ‹å››å¤§æ°‘é–“å‚³èªªä¸åŒ…æ‹¬å“ªä¸€å€‹ï¼Ÿ',
                        options: ['ç‰›éƒç¹”å¥³', 'å­Ÿå§œå¥³', 'ç™½è›‡å‚³', 'å«¦å¨¥å¥”æœˆ'],
                        correct: 3,
                        explanation: 'ä¸­åœ‹å››å¤§æ°‘é–“å‚³èªªæ˜¯ç‰›éƒç¹”å¥³ã€å­Ÿå§œå¥³å“­é•·åŸã€ç™½è›‡å‚³å’Œæ¢å±±ä¼¯èˆ‡ç¥è‹±å°ã€‚'
                    },
                    {
                        type: 'matching',
                        question: 'å°‡ä»¥ä¸‹ç¥è©±äººç‰©èˆ‡å…¶æ–‡åŒ–èƒŒæ™¯é…å°ï¼š',
                        pairs: [
                            { left: 'é›·ç¥ç´¢çˆ¾', right: 'åŒ—æ­ç¥è©±' },
                            { left: 'é˜¿æ³¢ç¾…', right: 'å¸Œè‡˜ç¥è©±' },
                            { left: 'å­«æ‚Ÿç©º', right: 'ä¸­åœ‹ç¥è©±' }
                        ],
                        explanation: 'é€™äº›ç¥è©±äººç‰©éƒ½æ˜¯å„è‡ªæ–‡åŒ–ä¸­çš„é‡è¦è§’è‰²ï¼Œé«”ç¾äº†ä¸åŒæ–‡æ˜çš„æƒ³åƒåŠ›ã€‚'
                    }
                ]
            },
            {
                id: 'martial-arts',
                title: 'æ­¦è¡“å‚³çµ±',
                description: 'æ¢ç´¢ä¸–ç•Œå„åœ°çš„å‚³çµ±æ­¦è¡“æ–‡åŒ–',
                icon: 'ğŸ¥‹',
                color: 'bg-orange-500',
                questions: [
                    {
                        type: 'multiple',
                        question: 'å¤ªæ¥µæ‹³èµ·æºæ–¼ä¸­åœ‹çš„å“ªå€‹çœä»½ï¼Ÿ',
                        options: ['æ²³å—', 'æ¹–åŒ—', 'æ±Ÿè˜‡', 'æµ™æ±Ÿ'],
                        correct: 0,
                        explanation: 'å¤ªæ¥µæ‹³èµ·æºæ–¼ä¸­åœ‹æ²³å—çœæº«ç¸£é™³å®¶æºï¼Œæ˜¯ä¸­åœ‹å‚³çµ±æ­¦è¡“çš„é‡è¦æµæ´¾ã€‚'
                    },
                    {
                        type: 'multiple',
                        question: 'ç©ºæ‰‹é“èµ·æºæ–¼å“ªå€‹åœ°å€ï¼Ÿ',
                        options: ['æ—¥æœ¬æœ¬åœŸ', 'æ²–ç¹©', 'æœé®®', 'ä¸­åœ‹'],
                        correct: 1,
                        explanation: 'ç©ºæ‰‹é“èµ·æºæ–¼æ²–ç¹©ï¼Œå¾Œä¾†å‚³æ’­åˆ°æ—¥æœ¬æœ¬åœŸä¸¦ç™¼å±•æˆç¾ä»£ç©ºæ‰‹é“ã€‚'
                    },
                    {
                        type: 'matching',
                        question: 'å°‡ä»¥ä¸‹æ­¦è¡“èˆ‡å…¶åŸç”¢åœ°é…å°ï¼š',
                        pairs: [
                            { left: 'è·†æ‹³é“', right: 'éŸ“åœ‹' },
                            { left: 'æŸ”é“', right: 'æ—¥æœ¬' },
                            { left: 'å¡æ³¢æ‹‰', right: 'å·´è¥¿' }
                        ],
                        explanation: 'æ¯ç¨®æ­¦è¡“éƒ½é«”ç¾äº†å…¶æ–‡åŒ–èƒŒæ™¯å’Œå“²å­¸æ€æƒ³ï¼Œæ˜¯èº«å¿ƒä¿®ç…‰çš„è—è¡“ã€‚'
                    }
                ]
            }
        ];

        function startLearning() {
            document.getElementById('welcomeScreen').classList.add('hidden');
            document.getElementById('courseScreen').classList.remove('hidden');
            generateCourseList();
            updateUI();
        }

        function generateCourseList() {
            const courseList = document.getElementById('courseList');
            courseList.innerHTML = '';

            courses.forEach(course => {
                const isCompleted = userProgress.completedCourses.includes(course.id);
                const courseCard = document.createElement('div');
                courseCard.className = `${course.color} rounded-lg p-6 text-white cursor-pointer transform transition-all duration-300 hover:scale-105 shadow-lg ${isCompleted ? 'opacity-75' : ''}`;
                courseCard.onclick = () => startCourse(course.id);

                courseCard.innerHTML = `
                    <div class="text-4xl mb-4">${course.icon}</div>
                    <h3 class="text-xl font-bold mb-2">${course.title}</h3>
                    <p class="text-sm opacity-90 mb-4">${course.description}</p>
                    <div class="flex items-center justify-between mb-3">
                        <span class="text-sm">${course.questions.length} å€‹å•é¡Œ</span>
                        ${isCompleted ? '<span class="text-lg">âœ…</span>' : '<span class="text-lg">ğŸ”’</span>'}
                    </div>
                    ${isCompleted ? `
                        <div class="border-t border-white border-opacity-30 pt-3">
                            <button onclick="requestCourseCertificate('${course.id}'); event.stopPropagation();" 
                                    class="w-full bg-white bg-opacity-20 hover:bg-opacity-30 text-white px-3 py-2 rounded text-sm font-medium transition-all duration-300">
                                ğŸ“œ ä¸‹è¼‰è­‰æ›¸
                            </button>
                        </div>
                    ` : ''}
                `;

                courseList.appendChild(courseCard);
            });

            updateOverallProgress();
        }

        function updateOverallProgress() {
            const totalCourses = courses.length;
            const completedCount = userProgress.completedCourses.length;
            const progressPercentage = (completedCount / totalCourses) * 100;
            
            document.getElementById('overallProgress').style.width = `${progressPercentage}%`;

            if (completedCount === totalCourses) {
                document.getElementById('certificateSection').style.display = 'block';
            }
        }

        function startCourse(courseId) {
            const course = courses.find(c => c.id === courseId);
            userProgress.currentCourse = course;
            userProgress.currentQuestion = 0;
            userProgress.lives = 3;

            document.getElementById('courseScreen').classList.add('hidden');
            document.getElementById('learningScreen').classList.remove('hidden');

            showQuestion();
        }

        function showQuestion() {
            const course = userProgress.currentCourse;
            const questionIndex = userProgress.currentQuestion;
            const question = course.questions[questionIndex];

            document.getElementById('questionProgress').textContent = `${questionIndex + 1} / ${course.questions.length}`;
            document.getElementById('progressBar').style.width = `${((questionIndex + 1) / course.questions.length) * 100}%`;

            const container = document.getElementById('questionContainer');
            container.innerHTML = '';

            if (question.type === 'multiple') {
                container.innerHTML = `
                    <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-6">
                        <h3 class="text-xl font-semibold mb-6">${question.question}</h3>
                        <div class="space-y-3">
                            ${question.options.map((option, index) => `
                                <button onclick="selectAnswer(${index})" 
                                        class="answer-option w-full text-left p-4 border-2 border-gray-200 dark:border-gray-600 rounded-lg hover:border-primary transition-all duration-300 text-base">
                                    ${option}
                                </button>
                            `).join('')}
                        </div>
                    </div>
                `;
            } else if (question.type === 'matching') {
                const shuffledRight = [...question.pairs.map(p => p.right)].sort(() => Math.random() - 0.5);
                container.innerHTML = `
                    <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-6">
                        <h3 class="text-xl font-semibold mb-6">${question.question}</h3>
                        <div class="grid md:grid-cols-2 gap-6">
                            <div class="space-y-3">
                                <h4 class="font-semibold text-center mb-4">é …ç›®</h4>
                                ${question.pairs.map((pair, index) => `
                                    <div class="matching-left p-3 bg-white dark:bg-gray-700 rounded border-2 border-gray-200 dark:border-gray-600 text-center text-base"
                                         data-value="${pair.right}">
                                        ${pair.left}
                                    </div>
                                `).join('')}
                            </div>
                            <div class="space-y-3">
                                <h4 class="font-semibold text-center mb-4">é¸é …</h4>
                                ${shuffledRight.map(option => `
                                    <div class="matching-right p-3 bg-primary text-white rounded cursor-pointer hover:bg-purple-700 transition-all duration-300 text-center text-base"
                                         onclick="selectMatching(this, '${option}')">
                                        ${option}
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        <div class="mt-6 text-center">
                            <button onclick="checkMatching()" 
                                    class="bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-lg font-semibold text-base">
                                æª¢æŸ¥ç­”æ¡ˆ
                            </button>
                        </div>
                    </div>
                `;
            }

            document.getElementById('feedback').classList.add('hidden');
            updateUI();
        }

        function selectAnswer(selectedIndex) {
            const question = userProgress.currentCourse.questions[userProgress.currentQuestion];
            const isCorrect = selectedIndex === question.correct;

            const options = document.querySelectorAll('.answer-option');
            options.forEach((option, index) => {
                option.disabled = true;
                if (index === question.correct) {
                    option.classList.add('border-green-500', 'bg-green-100', 'dark:bg-green-900');
                } else if (index === selectedIndex && !isCorrect) {
                    option.classList.add('border-red-500', 'bg-red-100', 'dark:bg-red-900');
                }
            });

            showFeedback(isCorrect, question.explanation);
        }

        let matchingSelections = {};

        function selectMatching(element, value) {
            // ç§»é™¤å…¶ä»–é¸ä¸­ç‹€æ…‹
            document.querySelectorAll('.matching-right').forEach(el => {
                el.classList.remove('bg-purple-800');
                el.classList.add('bg-primary');
            });

            element.classList.remove('bg-primary');
            element.classList.add('bg-purple-800');
            
            // æ¸…é™¤ä¹‹å‰çš„é¸æ“‡
            matchingSelections = {};
            
            // ç­‰å¾…ç”¨æˆ¶é»æ“Šå·¦å´é …ç›®
            document.querySelectorAll('.matching-left').forEach(leftEl => {
                leftEl.onclick = () => {
                    const expectedValue = leftEl.dataset.value;
                    matchingSelections[expectedValue] = value;
                    leftEl.style.backgroundColor = '#5D5CDE';
                    leftEl.style.color = 'white';
                    leftEl.innerHTML += ` â†’ ${value}`;
                    leftEl.onclick = null;
                };
            });
        }

        function checkMatching() {
            const question = userProgress.currentCourse.questions[userProgress.currentQuestion];
            let allCorrect = true;

            question.pairs.forEach(pair => {
                if (matchingSelections[pair.right] !== pair.right) {
                    allCorrect = false;
                }
            });

            showFeedback(allCorrect, question.explanation);
        }

        function showFeedback(isCorrect, explanation) {
            const feedback = document.getElementById('feedback');
            const feedbackContent = document.getElementById('feedbackContent');

            if (isCorrect) {
                userProgress.score += 20;
                feedbackContent.innerHTML = `
                    <div class="text-green-600 dark:text-green-400 text-xl font-bold mb-2">
                        âœ… ç­”å°äº†ï¼
                    </div>
                    <p class="text-gray-700 dark:text-gray-300">${explanation}</p>
                `;
                feedback.className = 'mt-6 p-4 rounded-lg text-center bg-green-100 dark:bg-green-900';
            } else {
                userProgress.lives--;
                feedbackContent.innerHTML = `
                    <div class="text-red-600 dark:text-red-400 text-xl font-bold mb-2">
                        âŒ ç­”éŒ¯äº†
                    </div>
                    <p class="text-gray-700 dark:text-gray-300">${explanation}</p>
                `;
                feedback.className = 'mt-6 p-4 rounded-lg text-center bg-red-100 dark:bg-red-900';

                if (userProgress.lives <= 0) {
                    showCustomModal('éŠæˆ²çµæŸ', 'å¾ˆéºæ†¾ï¼Œæ‚¨å·²ç¶“æ²’æœ‰ç”Ÿå‘½å€¼äº†ã€‚è«‹é‡æ–°é–‹å§‹é€™å€‹èª²ç¨‹ã€‚', () => {
                        backToCourses();
                    });
                    return;
                }
            }

            feedback.classList.remove('hidden');
            updateUI();
        }

        function nextQuestion() {
            userProgress.currentQuestion++;
            
            if (userProgress.currentQuestion >= userProgress.currentCourse.questions.length) {
                completeCourse();
            } else {
                showQuestion();
            }
        }

        function completeCourse() {
            const courseId = userProgress.currentCourse.id;
            if (!userProgress.completedCourses.includes(courseId)) {
                userProgress.completedCourses.push(courseId);
                userProgress.score += 100;
            }

            document.getElementById('learningScreen').classList.add('hidden');
            document.getElementById('completionScreen').classList.remove('hidden');
            
            document.getElementById('completedCourseName').textContent = userProgress.currentCourse.title;
            document.getElementById('certificateCourseName').textContent = userProgress.currentCourse.title;
            document.getElementById('earnedScore').textContent = '120';
            document.getElementById('currentStreak').textContent = userProgress.streak;
            
            updateUI();
        }

        function backToCourses() {
            document.getElementById('learningScreen').classList.add('hidden');
            document.getElementById('completionScreen').classList.add('hidden');
            document.getElementById('courseScreen').classList.remove('hidden');
            
            generateCourseList();
        }

        function updateUI() {
            document.getElementById('score').textContent = userProgress.score;
            document.getElementById('streak').textContent = userProgress.streak;
            document.getElementById('lives').textContent = userProgress.lives;
        }

        function showCustomModal(title, message, callback) {
            const modal = document.getElementById('customModal');
            const content = document.getElementById('modalContent');
            
            content.innerHTML = `
                <h3 class="text-xl font-bold mb-4">${title}</h3>
                <p class="text-gray-700 dark:text-gray-300 mb-6">${message}</p>
                <div class="flex justify-end space-x-3">
                    <button onclick="closeModal()" class="px-4 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded text-base">
                        å–æ¶ˆ
                    </button>
                    <button onclick="closeModal(); ${callback ? callback.name + '()' : ''}" class="px-4 py-2 bg-primary text-white hover:bg-purple-700 rounded text-base">
                        ç¢ºå®š
                    </button>
                </div>
            `;
            
            modal.classList.remove('hidden');
        }

        function closeModal() {
            document.getElementById('customModal').classList.add('hidden');
        }

        // é¡¯ç¤ºå§“åè¼¸å…¥å°è©±æ¡†
        function showNameInputDialog(callback) {
            const modal = document.getElementById('customModal');
            const content = document.getElementById('modalContent');
            
            content.innerHTML = `
                <h3 class="text-xl font-bold mb-4">ğŸ“œ è­‰æ›¸å€‹äººè³‡è¨Š</h3>
                <p class="text-gray-700 dark:text-gray-300 mb-4">è«‹è¼¸å…¥æ‚¨å¸Œæœ›åœ¨è­‰æ›¸ä¸Šé¡¯ç¤ºçš„å§“åï¼š</p>
                <input type="text" id="certificateName" placeholder="è«‹è¼¸å…¥æ‚¨çš„å§“å" 
                       value="${userProgress.userName}" 
                       class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg mb-6 text-base bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary">
                <div class="flex justify-end space-x-3">
                    <button onclick="closeModal()" class="px-4 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded text-base">
                        å–æ¶ˆ
                    </button>
                    <button onclick="confirmName('${callback.name}')" class="px-4 py-2 bg-primary text-white hover:bg-purple-700 rounded text-base">
                        ç”Ÿæˆè­‰æ›¸
                    </button>
                </div>
            `;
            
            modal.classList.remove('hidden');
            
            // èšç„¦åˆ°è¼¸å…¥æ¡†
            setTimeout(() => {
                document.getElementById('certificateName').focus();
            }, 100);
            
            // æ”¯æŒEnteréµç¢ºèª
            document.getElementById('certificateName').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    confirmName(callback.name);
                }
            });
        }

        function confirmName(callbackName) {
            const nameInput = document.getElementById('certificateName');
            const name = nameInput.value.trim();
            
            if (!name) {
                // é¡¯ç¤ºéŒ¯èª¤æç¤º
                nameInput.classList.add('border-red-500');
                nameInput.placeholder = 'è«‹è¼¸å…¥å§“å';
                return;
            }
            
            // å„²å­˜ç”¨æˆ¶å§“å
            userProgress.userName = name;
            closeModal();
            
            // åŸ·è¡Œå°æ‡‰çš„è­‰æ›¸ç”Ÿæˆå‡½æ•¸
            if (callbackName === 'generateCourseCertificateWithName') {
                generateCourseCertificateWithName();
            } else if (callbackName === 'generateCertificateWithName') {
                generateCertificateWithName();
            } else if (callbackName.startsWith('downloadCourseCertificateWithName_')) {
                const courseId = callbackName.split('_')[1];
                downloadCourseCertificateWithName(courseId);
            }
        }

        function generateCertificate() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            // è¨­ç½®å­—é«”ï¼ˆä½¿ç”¨å…§å»ºå­—é«”ï¼‰
            doc.setFont("helvetica");

            // æ·»åŠ è£é£¾é‚Šæ¡†
            doc.setLineWidth(5);
            doc.setDrawColor(212, 175, 55); // heritage-gold
            doc.rect(10, 10, 190, 277);

            doc.setLineWidth(2);
            doc.setDrawColor(220, 20, 60); // heritage-red
            doc.rect(15, 15, 180, 267);

            // æ¨™é¡Œ
            doc.setFontSize(28);
            doc.setTextColor(93, 92, 222); // primary color
            doc.text('Cultural Heritage Academy', 105, 50, { align: 'center' });

            doc.setFontSize(24);
            doc.setTextColor(212, 175, 55); // heritage-gold
            doc.text('Certificate of Completion', 105, 70, { align: 'center' });

            // å…§å®¹
            doc.setFontSize(16);
            doc.setTextColor(0, 0, 0);
            doc.text('This is to certify that', 105, 100, { align: 'center' });

            doc.setFontSize(20);
            doc.setTextColor(93, 92, 222);
            doc.text('Heritage Scholar', 105, 120, { align: 'center' });

            doc.setFontSize(16);
            doc.setTextColor(0, 0, 0);
            doc.text('has successfully completed all courses in', 105, 140, { align: 'center' });

            doc.setFontSize(18);
            doc.setTextColor(212, 175, 55);
            doc.text('Intangible Cultural Heritage Studies', 105, 160, { align: 'center' });

            doc.setFontSize(14);
            doc.text('Total Score: ' + userProgress.score + ' points', 105, 180, { align: 'center' });
            doc.text('Courses Completed: ' + userProgress.completedCourses.length + '/' + courses.length, 105, 195, { align: 'center' });

            // æ—¥æœŸ
            const currentDate = new Date().toLocaleDateString('zh-TW');
            doc.setFontSize(12);
            doc.text('Date: ' + currentDate, 105, 220, { align: 'center' });

            // ç°½åå€åŸŸ
            doc.setFontSize(14);
            doc.text('Cultural Heritage Academy', 105, 250, { align: 'center' });
            doc.text('Director of Studies', 105, 265, { align: 'center' });

            // ä¸‹è¼‰PDF
            doc.save('Cultural_Heritage_Certificate.pdf');
        }

        // ç”Ÿæˆå–®å€‹èª²ç¨‹è­‰æ›¸
        function generateCourseCertificate() {
            const course = userProgress.currentCourse;
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            // è¨­ç½®å­—é«”
            doc.setFont("helvetica");

            // æ·»åŠ è£é£¾é‚Šæ¡†
            doc.setLineWidth(5);
            doc.setDrawColor(212, 175, 55); // heritage-gold
            doc.rect(10, 10, 190, 277);

            doc.setLineWidth(2);
            doc.setDrawColor(220, 20, 60); // heritage-red
            doc.rect(15, 15, 180, 267);

            // æ¨™é¡Œ
            doc.setFontSize(28);
            doc.setTextColor(93, 92, 222); // primary color
            doc.text('Cultural Heritage Academy', 105, 45, { align: 'center' });

            doc.setFontSize(22);
            doc.setTextColor(212, 175, 55); // heritage-gold
            doc.text('Course Completion Certificate', 105, 65, { align: 'center' });

            // èª²ç¨‹åœ–æ¨™ï¼ˆä½¿ç”¨æ–‡å­—ä»£æ›¿ï¼‰
            doc.setFontSize(40);
            doc.text(course.icon, 105, 95, { align: 'center' });

            // å…§å®¹
            doc.setFontSize(16);
            doc.setTextColor(0, 0, 0);
            doc.text('This is to certify that', 105, 115, { align: 'center' });

            doc.setFontSize(20);
            doc.setTextColor(93, 92, 222);
            doc.text('Heritage Scholar', 105, 135, { align: 'center' });

            doc.setFontSize(16);
            doc.setTextColor(0, 0, 0);
            doc.text('has successfully completed the course', 105, 155, { align: 'center' });

            // èª²ç¨‹åç¨±
            doc.setFontSize(18);
            doc.setTextColor(212, 175, 55);
            doc.text(course.title, 105, 175, { align: 'center' });

            // èª²ç¨‹æè¿°
            doc.setFontSize(12);
            doc.setTextColor(100, 100, 100);
            doc.text(course.description, 105, 190, { align: 'center' });

            // èª²ç¨‹è©³æƒ…
            doc.setFontSize(14);
            doc.setTextColor(0, 0, 0);
            doc.text('Questions Completed: ' + course.questions.length, 105, 210, { align: 'center' });
            doc.text('Course Score: 120 points', 105, 225, { align: 'center' });

            // æ—¥æœŸ
            const currentDate = new Date().toLocaleDateString('zh-TW');
            doc.setFontSize(12);
            doc.text('Completion Date: ' + currentDate, 105, 245, { align: 'center' });

            // ç°½åå€åŸŸ
            doc.setFontSize(14);
            doc.text('Cultural Heritage Academy', 105, 265, { align: 'center' });
            doc.text('Course Instructor', 105, 280, { align: 'center' });

            // ä¸‹è¼‰PDF
            const fileName = `${course.title.replace(/\s+/g, '_')}_Certificate.pdf`;
            doc.save(fileName);
        }

        // å¾èª²ç¨‹åˆ—è¡¨ä¸‹è¼‰è­‰æ›¸
        function downloadCourseCertificate(courseId) {
            const course = courses.find(c => c.id === courseId);
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            // è¨­ç½®å­—é«”
            doc.setFont("helvetica");

            // æ·»åŠ è£é£¾é‚Šæ¡†
            doc.setLineWidth(5);
            doc.setDrawColor(212, 175, 55); // heritage-gold
            doc.rect(10, 10, 190, 277);

            doc.setLineWidth(2);
            doc.setDrawColor(220, 20, 60); // heritage-red
            doc.rect(15, 15, 180, 267);

            // æ¨™é¡Œ
            doc.setFontSize(28);
            doc.setTextColor(93, 92, 222); // primary color
            doc.text('Cultural Heritage Academy', 105, 45, { align: 'center' });

            doc.setFontSize(22);
            doc.setTextColor(212, 175, 55); // heritage-gold
            doc.text('Course Completion Certificate', 105, 65, { align: 'center' });

            // èª²ç¨‹åœ–æ¨™
            doc.setFontSize(40);
            doc.text(course.icon, 105, 95, { align: 'center' });

            // å…§å®¹
            doc.setFontSize(16);
            doc.setTextColor(0, 0, 0);
            doc.text('This is to certify that', 105, 115, { align: 'center' });

            doc.setFontSize(20);
            doc.setTextColor(93, 92, 222);
            doc.text('Heritage Scholar', 105, 135, { align: 'center' });

            doc.setFontSize(16);
            doc.setTextColor(0, 0, 0);
            doc.text('has successfully completed the course', 105, 155, { align: 'center' });

            // èª²ç¨‹åç¨±
            doc.setFontSize(18);
            doc.setTextColor(212, 175, 55);
            doc.text(course.title, 105, 175, { align: 'center' });

            // èª²ç¨‹æè¿°
            doc.setFontSize(12);
            doc.setTextColor(100, 100, 100);
            doc.text(course.description, 105, 190, { align: 'center' });

            // èª²ç¨‹è©³æƒ…
            doc.setFontSize(14);
            doc.setTextColor(0, 0, 0);
            doc.text('Questions Completed: ' + course.questions.length, 105, 210, { align: 'center' });
            doc.text('Course Score: 120 points', 105, 225, { align: 'center' });

            // æ—¥æœŸ
            const currentDate = new Date().toLocaleDateString('zh-TW');
            doc.setFontSize(12);
            doc.text('Completion Date: ' + currentDate, 105, 245, { align: 'center' });

            // ç°½åå€åŸŸ
            doc.setFontSize(14);
            doc.text('Cultural Heritage Academy', 105, 265, { align: 'center' });
            doc.text('Course Instructor', 105, 280, { align: 'center' });

            // ä¸‹è¼‰PDF
            const fileName = `${course.title.replace(/\s+/g, '_')}_Certificate.pdf`;
            doc.save(fileName);
        }

        // å¸¶å§“åçš„è­‰æ›¸ç”Ÿæˆå‡½æ•¸
        function generateCertificateWithName() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            // è¨­ç½®å­—é«”
            doc.setFont("helvetica");

            // æ·»åŠ è£é£¾é‚Šæ¡†
            doc.setLineWidth(5);
            doc.setDrawColor(212, 175, 55); // heritage-gold
            doc.rect(10, 10, 190, 277);

            doc.setLineWidth(2);
            doc.setDrawColor(220, 20, 60); // heritage-red
            doc.rect(15, 15, 180, 267);

            // æ¨™é¡Œ
            doc.setFontSize(28);
            doc.setTextColor(93, 92, 222); // primary color
            doc.text('Cultural Heritage Academy', 105, 50, { align: 'center' });

            doc.setFontSize(24);
            doc.setTextColor(212, 175, 55); // heritage-gold
            doc.text('Certificate of Completion', 105, 70, { align: 'center' });

            // å…§å®¹
            doc.setFontSize(16);
            doc.setTextColor(0, 0, 0);
            doc.text('This is to certify that', 105, 100, { align: 'center' });

            doc.setFontSize(20);
            doc.setTextColor(93, 92, 222);
            doc.text(userProgress.userName, 105, 120, { align: 'center' });

            doc.setFontSize(16);
            doc.setTextColor(0, 0, 0);
            doc.text('has successfully completed all courses in', 105, 140, { align: 'center' });

            doc.setFontSize(18);
            doc.setTextColor(212, 175, 55);
            doc.text('Intangible Cultural Heritage Studies', 105, 160, { align: 'center' });

            doc.setFontSize(14);
            doc.text('Total Score: ' + userProgress.score + ' points', 105, 180, { align: 'center' });
            doc.text('Courses Completed: ' + userProgress.completedCourses.length + '/' + courses.length, 105, 195, { align: 'center' });

            // æ—¥æœŸ
            const currentDate = new Date().toLocaleDateString('zh-TW');
            doc.setFontSize(12);
            doc.text('Date: ' + currentDate, 105, 220, { align: 'center' });

            // ç°½åå€åŸŸ
            doc.setFontSize(14);
            doc.text('Cultural Heritage Academy', 105, 250, { align: 'center' });
            doc.text('Director of Studies', 105, 265, { align: 'center' });

            // ä¸‹è¼‰PDF
            const fileName = `${userProgress.userName.replace(/\s+/g, '_')}_Cultural_Heritage_Certificate.pdf`;
            doc.save(fileName);
        }

        function generateCourseCertificateWithName() {
            const course = userProgress.currentCourse;
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            // è¨­ç½®å­—é«”
            doc.setFont("helvetica");

            // æ·»åŠ è£é£¾é‚Šæ¡†
            doc.setLineWidth(5);
            doc.setDrawColor(212, 175, 55); // heritage-gold
            doc.rect(10, 10, 190, 277);

            doc.setLineWidth(2);
            doc.setDrawColor(220, 20, 60); // heritage-red
            doc.rect(15, 15, 180, 267);

            // æ¨™é¡Œ
            doc.setFontSize(28);
            doc.setTextColor(93, 92, 222); // primary color
            doc.text('Cultural Heritage Academy', 105, 45, { align: 'center' });

            doc.setFontSize(22);
            doc.setTextColor(212, 175, 55); // heritage-gold
            doc.text('Course Completion Certificate', 105, 65, { align: 'center' });

            // èª²ç¨‹åœ–æ¨™
            doc.setFontSize(40);
            doc.text(course.icon, 105, 95, { align: 'center' });

            // å…§å®¹
            doc.setFontSize(16);
            doc.setTextColor(0, 0, 0);
            doc.text('This is to certify that', 105, 115, { align: 'center' });

            doc.setFontSize(20);
            doc.setTextColor(93, 92, 222);
            doc.text(userProgress.userName, 105, 135, { align: 'center' });

            doc.setFontSize(16);
            doc.setTextColor(0, 0, 0);
            doc.text('has successfully completed the course', 105, 155, { align: 'center' });

            // èª²ç¨‹åç¨±
            doc.setFontSize(18);
            doc.setTextColor(212, 175, 55);
            doc.text(course.title, 105, 175, { align: 'center' });

            // èª²ç¨‹æè¿°
            doc.setFontSize(12);
            doc.setTextColor(100, 100, 100);
            doc.text(course.description, 105, 190, { align: 'center' });

            // èª²ç¨‹è©³æƒ…
            doc.setFontSize(14);
            doc.setTextColor(0, 0, 0);
            doc.text('Questions Completed: ' + course.questions.length, 105, 210, { align: 'center' });
            doc.text('Course Score: 120 points', 105, 225, { align: 'center' });

            // æ—¥æœŸ
            const currentDate = new Date().toLocaleDateString('zh-TW');
            doc.setFontSize(12);
            doc.text('Completion Date: ' + currentDate, 105, 245, { align: 'center' });

            // ç°½åå€åŸŸ
            doc.setFontSize(14);
            doc.text('Cultural Heritage Academy', 105, 265, { align: 'center' });
            doc.text('Course Instructor', 105, 280, { align: 'center' });

            // ä¸‹è¼‰PDF
            const fileName = `${userProgress.userName.replace(/\s+/g, '_')}_${course.title.replace(/\s+/g, '_')}_Certificate.pdf`;
            doc.save(fileName);
        }

        function downloadCourseCertificateWithName(courseId) {
            const course = courses.find(c => c.id === courseId);
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            // è¨­ç½®å­—é«”
            doc.setFont("helvetica");

            // æ·»åŠ è£é£¾é‚Šæ¡†
            doc.setLineWidth(5);
            doc.setDrawColor(212, 175, 55); // heritage-gold
            doc.rect(10, 10, 190, 277);

            doc.setLineWidth(2);
            doc.setDrawColor(220, 20, 60); // heritage-red
            doc.rect(15, 15, 180, 267);

            // æ¨™é¡Œ
            doc.setFontSize(28);
            doc.setTextColor(93, 92, 222); // primary color
            doc.text('Cultural Heritage Academy', 105, 45, { align: 'center' });

            doc.setFontSize(22);
            doc.setTextColor(212, 175, 55); // heritage-gold
            doc.text('Course Completion Certificate', 105, 65, { align: 'center' });

            // èª²ç¨‹åœ–æ¨™
            doc.setFontSize(40);
            doc.text(course.icon, 105, 95, { align: 'center' });

            // å…§å®¹
            doc.setFontSize(16);
            doc.setTextColor(0, 0, 0);
            doc.text('This is to certify that', 105, 115, { align: 'center' });

            doc.setFontSize(20);
            doc.setTextColor(93, 92, 222);
            doc.text(userProgress.userName, 105, 135, { align: 'center' });

            doc.setFontSize(16);
            doc.setTextColor(0, 0, 0);
            doc.text('has successfully completed the course', 105, 155, { align: 'center' });

            // èª²ç¨‹åç¨±
            doc.setFontSize(18);
            doc.setTextColor(212, 175, 55);
            doc.text(course.title, 105, 175, { align: 'center' });

            // èª²ç¨‹æè¿°
            doc.setFontSize(12);
            doc.setTextColor(100, 100, 100);
            doc.text(course.description, 105, 190, { align: 'center' });

            // èª²ç¨‹è©³æƒ…
            doc.setFontSize(14);
            doc.setTextColor(0, 0, 0);
            doc.text('Questions Completed: ' + course.questions.length, 105, 210, { align: 'center' });
            doc.text('Course Score: 120 points', 105, 225, { align: 'center' });

            // æ—¥æœŸ
            const currentDate = new Date().toLocaleDateString('zh-TW');
            doc.setFontSize(12);
            doc.text('Completion Date: ' + currentDate, 105, 245, { align: 'center' });

            // ç°½åå€åŸŸ
            doc.setFontSize(14);
            doc.text('Cultural Heritage Academy', 105, 265, { align: 'center' });
            doc.text('Course Instructor', 105, 280, { align: 'center' });

            // ä¸‹è¼‰PDF
            const fileName = `${userProgress.userName.replace(/\s+/g, '_')}_${course.title.replace(/\s+/g, '_')}_Certificate.pdf`;
            doc.save(fileName);
        }

        // è™•ç†èª²ç¨‹åˆ—è¡¨ä¸­çš„è­‰æ›¸ä¸‹è¼‰è«‹æ±‚
        function requestCourseCertificate(courseId) {
            // å‰µå»ºä¸€å€‹è‡¨æ™‚çš„å›èª¿å‡½æ•¸
            window.tempCertificateCallback = function() {
                return `downloadCourseCertificateWithName_${courseId}`;
            };
            showNameInputDialog(window.tempCertificateCallback);
        }

        // é¡¯ç¤ºå¸«çˆ¶æ¨è–¦
        function showMasterRecommendations() {
            const currentCourseId = userProgress.currentCourse.id;
            const courseMasters = masters[currentCourseId] || [];
            const modal = document.getElementById('customModal');
            const content = document.getElementById('modalContent');
            
            content.innerHTML = `
                <div class="max-w-2xl">
                    <h3 class="text-2xl font-bold mb-4 text-center">ğŸ¯ ${userProgress.currentCourse.title} é ˜åŸŸå¸«çˆ¶</h3>
                    <p class="text-gray-600 dark:text-gray-300 mb-6 text-center">
                        æˆ‘å€‘ç‚ºæ‚¨æ¨è–¦åœ¨æ­¤é ˜åŸŸç¶“é©—è±å¯Œçš„å°ˆæ¥­å¸«çˆ¶ï¼Œæ¯ä½éƒ½æœ‰ç¨ç‰¹çš„æ•™å­¸é¢¨æ ¼å’Œæ·±åšçš„æ–‡åŒ–åº•è˜Šã€‚
                    </p>
                    
                    <div class="space-y-4 max-h-96 overflow-y-auto">
                        ${courseMasters.map(master => `
                            <div class="border border-gray-200 dark:border-gray-600 rounded-lg p-4 hover:shadow-lg transition-all duration-300 cursor-pointer"
                                 onclick="showMasterDetails('${master.id}')">
                                <div class="flex items-start space-x-4">
                                    <div class="w-16 h-16 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center text-2xl text-white font-bold">
                                        ${master.name.charAt(0)}
                                    </div>
                                    <div class="flex-1">
                                        <h4 class="text-lg font-bold text-gray-900 dark:text-white">${master.name}</h4>
                                        <p class="text-purple-600 dark:text-purple-400 font-medium">${master.title}</p>
                                        <p class="text-sm text-gray-600 dark:text-gray-300 mt-1">
                                            ğŸ“ ${master.location} | ğŸ“ ${master.experience} ç¶“é©—
                                        </p>
                                        <div class="flex flex-wrap gap-1 mt-2">
                                            ${master.specialties.slice(0, 2).map(specialty => 
                                                `<span class="px-2 py-1 bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-300 text-xs rounded-full">${specialty}</span>`
                                            ).join('')}
                                        </div>
                                    </div>
                                    <div class="text-purple-500 text-xl">â†’</div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div class="mt-6 text-center">
                        <button onclick="closeModal()" 
                                class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-300">
                            é—œé–‰
                        </button>
                    </div>
                </div>
            `;
            
            modal.classList.remove('hidden');
        }

        // é¡¯ç¤ºå¸«çˆ¶è©³ç´°è³‡è¨Š
        function showMasterDetails(masterId) {
            // å¾æ‰€æœ‰å¸«çˆ¶ä¸­æ‰¾åˆ°å°æ‡‰çš„å¸«çˆ¶
            let masterData = null;
            for (const courseId in masters) {
                const master = masters[courseId].find(m => m.id === masterId);
                if (master) {
                    masterData = master;
                    break;
                }
            }
            
            if (!masterData) return;
            
            const modal = document.getElementById('customModal');
            const content = document.getElementById('modalContent');
            
            content.innerHTML = `
                <div class="max-w-3xl">
                    <div class="text-center mb-6">
                        <div class="w-24 h-24 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center text-3xl text-white font-bold mx-auto mb-4">
                            ${masterData.name.charAt(0)}
                        </div>
                        <h3 class="text-2xl font-bold text-gray-900 dark:text-white">${masterData.name}</h3>
                        <p class="text-lg text-purple-600 dark:text-purple-400 font-medium">${masterData.title}</p>
                        <p class="text-gray-600 dark:text-gray-300">ğŸ“ ${masterData.location} | ğŸ“ ${masterData.experience} æ•™å­¸ç¶“é©—</p>
                    </div>
                    
                    <div class="space-y-6 max-h-96 overflow-y-auto">
                        <div>
                            <h4 class="font-bold text-gray-900 dark:text-white mb-2">ğŸ“ å¸«çˆ¶ç°¡ä»‹</h4>
                            <p class="text-gray-700 dark:text-gray-300 text-sm leading-relaxed">${masterData.description}</p>
                        </div>
                        
                        <div>
                            <h4 class="font-bold text-gray-900 dark:text-white mb-2">ğŸ¯ å°ˆæ¥­é ˜åŸŸ</h4>
                            <div class="flex flex-wrap gap-2">
                                ${masterData.specialties.map(specialty => 
                                    `<span class="px-3 py-1 bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded-full text-sm">${specialty}</span>`
                                ).join('')}
                            </div>
                        </div>
                        
                        <div>
                            <h4 class="font-bold text-gray-900 dark:text-white mb-2">ğŸ† ä¸»è¦æˆå°±</h4>
                            <ul class="space-y-1">
                                ${masterData.achievements.map(achievement => 
                                    `<li class="text-gray-700 dark:text-gray-300 text-sm flex items-start space-x-2">
                                        <span class="text-yellow-500 mt-1">â€¢</span>
                                        <span>${achievement}</span>
                                    </li>`
                                ).join('')}
                            </ul>
                        </div>
                        
                        <div>
                            <h4 class="font-bold text-gray-900 dark:text-white mb-2">ğŸ‘¨â€ğŸ« æ•™å­¸é¢¨æ ¼</h4>
                            <p class="text-gray-700 dark:text-gray-300 text-sm leading-relaxed">${masterData.teachingStyle}</p>
                        </div>
                        
                        <div class="bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900 dark:to-pink-900 rounded-lg p-4">
                            <h4 class="font-bold text-gray-900 dark:text-white mb-2">ğŸ“§ è¯ç¹«æ–¹å¼</h4>
                            <p class="text-gray-700 dark:text-gray-300 text-sm mb-3">
                                æƒ³è¦æ‹œå¸«å­¸è—å—ï¼Ÿæ‚¨å¯ä»¥é€éä»¥ä¸‹æ–¹å¼èˆ‡å¸«çˆ¶è¯ç¹«ï¼š
                            </p>
                            <div class="flex items-center space-x-3">
                                <button onclick="contactMaster('${masterData.contact}')" 
                                        class="bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-all duration-300">
                                    ğŸ“§ ç™¼é€è¯ç¹«éƒµä»¶
                                </button>
                                <span class="text-gray-600 dark:text-gray-400 text-sm">${masterData.contact}</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-6 flex justify-center space-x-3">
                        <button onclick="showMasterRecommendations()" 
                                class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-300">
                            â† è¿”å›å¸«çˆ¶åˆ—è¡¨
                        </button>
                        <button onclick="closeModal()" 
                                class="bg-primary hover:bg-purple-700 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-300">
                            é—œé–‰
                        </button>
                    </div>
                </div>
            `;
            
            modal.classList.remove('hidden');
        }

        // è¯ç¹«å¸«çˆ¶åŠŸèƒ½
        function contactMaster(email) {
            const subject = encodeURIComponent(`ä¾†è‡ªæ–‡åŒ–å‚³æ‰¿å­¸é™¢çš„å­¸ç¿’è€… - ${userProgress.currentCourse.title}èª²ç¨‹`);
            const body = encodeURIComponent(`è¦ªæ„›çš„å¸«çˆ¶æ‚¨å¥½ï¼Œ

æˆ‘æ˜¯${userProgress.userName}ï¼Œå‰›å‰›å®Œæˆäº†æ–‡åŒ–å‚³æ‰¿å­¸é™¢çš„ã€Œ${userProgress.currentCourse.title}ã€èª²ç¨‹ã€‚

æˆ‘å°æ‚¨çš„å°ˆæ¥­é ˜åŸŸéå¸¸æ„Ÿèˆˆè¶£ï¼Œå¸Œæœ›èƒ½æœ‰æ©Ÿæœƒè·Ÿéš¨æ‚¨æ·±å…¥å­¸ç¿’å‚³çµ±æ–‡åŒ–æŠ€è—ã€‚

æˆ‘çš„å­¸ç¿’èƒŒæ™¯ï¼š
- å·²å®Œæˆèª²ç¨‹ï¼š${userProgress.completedCourses.length}å€‹
- ç¸½å­¸ç¿’ç©åˆ†ï¼š${userProgress.score}åˆ†
- å­¸ç¿’æ…‹åº¦ï¼šèªçœŸåˆ»è‹¦ï¼Œæ¸´æœ›å‚³æ‰¿æ–‡åŒ–ç²¾é«“

æœŸå¾…æ‚¨çš„å›è¦†ï¼Œè¬è¬ï¼

æ­¤è‡´
æ•¬ç¦®

${userProgress.userName}
ä¾†è‡ªæ–‡åŒ–å‚³æ‰¿å­¸é™¢`);
            
            const mailtoLink = `mailto:${email}?subject=${subject}&body=${body}`;
            window.open(mailtoLink);
        }

        // å·¥è—å¸‚é›†å•†å“æ•¸æ“š
        const marketplaceItems = [
            // å‚³çµ±æ‰‹å·¥è—ä½œå“
            {
                id: 'item-1',
                title: 'æ‰‹å·¥æ™¯æ³°è—èŠ±ç“¶',
                category: 'traditional-crafts',
                price: 2800,
                seller: 'ææ™¯æ³°å·¥ä½œå®¤',
                sellerType: 'master',
                location: 'åŒ—äº¬',
                image: 'ğŸº',
                description: 'æ¡ç”¨å‚³çµ±æ™¯æ³°è—å·¥è—è£½ä½œï¼ŒéŠ…èƒæçµ²çºç‘¯ï¼ŒèŠ±å‰åœ–æ¡ˆç²¾ç¾ï¼Œé©åˆæ”¶è—æˆ–è£é£¾ã€‚',
                specifications: ['é«˜åº¦ï¼š25cm', 'ç›´å¾‘ï¼š15cm', 'é‡é‡ï¼š1.2kg'],
                materials: ['ç´«éŠ…', 'çºç‘¯å½©', 'é‡‘çµ²'],
                craftTime: '15å¤©',
                condition: 'å…¨æ–°',
                featured: true
            },
            {
                id: 'item-2',
                title: 'ç«‹é«”æŠ˜ç´™è—è¡“-åƒç´™é¶´ç·¨ç¹”',
                category: 'traditional-crafts',
                price: 180,
                seller: 'æ‘ºç´™æ„›å¥½è€…å°æ—',
                sellerType: 'student',
                location: 'æ±äº¬',
                image: 'ğŸ¦',
                description: '100éš»æ‰‹å·¥æ‘ºç–Šåƒç´™é¶´çµ„æˆçš„ç«‹é«”è—è¡“è£ç½®ï¼Œå¯“æ„å’Œå¹³èˆ‡å¸Œæœ›ã€‚',
                specifications: ['å°ºå¯¸ï¼š30x30x20cm', 'æ•¸é‡ï¼š100éš»', 'æ¡†æ¶ï¼šæœ¨è³ª'],
                materials: ['å’Œç´™', 'é‡‘éŠ€ç´™', 'æœ¨æ¡†'],
                craftTime: '7å¤©',
                condition: 'å…¨æ–°'
            },
            // æ°‘æ—éŸ³æ¨‚ç›¸é—œ
            {
                id: 'item-3',
                title: 'æ‰‹å·¥è£½ä½œå¤ç´-ä»²å°¼å¼',
                category: 'folk-music',
                price: 15000,
                seller: 'è˜‡å·å¤ç´åŠ',
                sellerType: 'master',
                location: 'è˜‡å·',
                image: 'ğŸµ',
                description: 'æ¡ç”¨ç™¾å¹´è€æ‰æœ¨è£½ä½œï¼ŒéŸ³è‰²æ¸…é›…ï¼Œé©åˆæ¼”å¥å’Œæ”¶è—ã€‚',
                specifications: ['é•·åº¦ï¼š120cm', 'å¯¬åº¦ï¼š20cm', 'å¼¦æ•¸ï¼š7æ ¹'],
                materials: ['è€æ‰æœ¨', 'çµ²å¼¦', 'ç”Ÿæ¼†'],
                craftTime: '90å¤©',
                condition: 'å…¨æ–°',
                featured: true
            },
            {
                id: 'item-4',
                title: 'æ„›çˆ¾è˜­å‚³çµ±é¢¨ç¬›',
                category: 'folk-music',
                price: 3200,
                seller: 'Celtic Music Workshop',
                sellerType: 'master',
                location: 'éƒ½æŸæ—',
                image: 'ğŸ­',
                description: 'æ‰‹å·¥è£½ä½œçš„æ„›çˆ¾è˜­é¢¨ç¬›ï¼ŒéŸ³è³ªç´”æ­£ï¼Œé©åˆæ¼”å¥å‚³çµ±å‡±çˆ¾ç‰¹éŸ³æ¨‚ã€‚',
                specifications: ['æè³ªï¼šé»‘æª€æœ¨', 'èª¿æ€§ï¼šDèª¿', 'é…ä»¶é½Šå…¨'],
                materials: ['é»‘æª€æœ¨', 'ç¾Šçš®å›Š', 'éŠ…ç®¡'],
                craftTime: '30å¤©',
                condition: 'å…¨æ–°'
            },
            // ç¯€æ…¶ç”¨å“
            {
                id: 'item-5',
                title: 'æ‰‹å·¥å‰ªç´™ä½œå“é›†-åäºŒç”Ÿè‚–',
                category: 'festivals',
                price: 450,
                seller: 'æ°‘ä¿—è—è¡“å­¸ç”Ÿæœƒ',
                sellerType: 'student',
                location: 'ç¦å»º',
                image: 'ğŸŠ',
                description: 'å‚³çµ±å‰ªç´™æŠ€æ³•è£½ä½œçš„åäºŒç”Ÿè‚–ç³»åˆ—ï¼Œé©åˆæ˜¥ç¯€è£é£¾ã€‚',
                specifications: ['å°ºå¯¸ï¼š20x20cmæ¯å¹…', 'æ•¸é‡ï¼š12å¹…', 'è£è£±ï¼šå·è»¸è£'],
                materials: ['ç´…ç´™', 'é‡‘ç´™', 'çµ²ç¶¢å·è»¸'],
                craftTime: '5å¤©',
                condition: 'å…¨æ–°'
            },
            {
                id: 'item-6',
                title: 'å°åº¦è‰²å½©ç¯€æœ‰æ©Ÿé¡æ–™å¥—è£',
                category: 'festivals',
                price: 280,
                seller: 'Holi Colors India',
                sellerType: 'master',
                location: 'æ–°å¾·é‡Œ',
                image: 'ğŸŒˆ',
                description: 'ç´”å¤©ç„¶æœ‰æ©Ÿé¡æ–™ï¼Œå®‰å…¨ç„¡æ¯’ï¼Œé©åˆè‰²å½©ç¯€æ…¶ç¥æ´»å‹•ã€‚',
                specifications: ['é¡è‰²ï¼š8ç¨®', 'é‡é‡ï¼š100gæ¯åŒ…', 'åŒ…è£ï¼šç’°ä¿è¢‹'],
                materials: ['å¤©ç„¶æ¤ç‰©æŸ“æ–™', 'ç‰ç±³æ¾±ç²‰', 'æœ‰æ©Ÿæ·»åŠ åŠ‘'],
                craftTime: '3å¤©',
                condition: 'å…¨æ–°'
            },
            // çƒ¹é£ªè—è¡“
            {
                id: 'item-7',
                title: 'æ³•å¼æ–™ç†é†¬æ–™å¥—è£',
                category: 'culinary-arts',
                price: 680,
                seller: 'Chef Pierreå·¥ä½œå®¤',
                sellerType: 'master',
                location: 'å·´é»',
                image: 'ğŸœ',
                description: 'ç¶“å…¸æ³•å¼äº”å¤§æ¯é†¬æ‰‹å·¥è£½ä½œå¥—è£ï¼ŒåŒ…å«è©³ç´°è£½ä½œèªªæ˜ã€‚',
                specifications: ['æ•¸é‡ï¼š5ç¨®é†¬æ–™', 'å®¹é‡ï¼š200mlæ¯ç“¶', 'ä¿å­˜æœŸï¼š3å€‹æœˆ'],
                materials: ['æœ‰æ©Ÿå¥¶æ²¹', 'å¤©ç„¶é¦™è‰', 'æ³•å¼é«˜æ¹¯'],
                craftTime: '2å¤©',
                condition: 'å…¨æ–°',
                featured: true
            },
            {
                id: 'item-8',
                title: 'æ‡·çŸ³æ–™ç†å™¨çš¿çµ„åˆ',
                category: 'culinary-arts',
                price: 2400,
                seller: 'äº¬éƒ½é™¶è—å·¥æˆ¿',
                sellerType: 'student',
                location: 'äº¬éƒ½',
                image: 'ğŸº',
                description: 'æ‰‹å·¥é™¶ç“·å™¨çš¿ï¼Œé©åˆæ‡·çŸ³æ–™ç†æ“ºç›¤ï¼Œé«”ç¾æ—¥å¼ç¾å­¸ã€‚',
                specifications: ['ä»¶æ•¸ï¼š12ä»¶', 'æè³ªï¼šé™¶ç“·', 'é¢¨æ ¼ï¼šç°¡ç´„'],
                materials: ['å„ªè³ªé™¶åœŸ', 'å¤©ç„¶é‡‰æ–™', 'æ‰‹å·¥æ‹‰å¯'],
                craftTime: '20å¤©',
                condition: 'å…¨æ–°'
            },
            // å£è¿°å‚³çµ±ç›¸é—œ
            {
                id: 'item-9',
                title: 'æ‰‹ç¹ªæ’åœ–ç‰ˆæ ¼æ—ç«¥è©±é›†',
                category: 'storytelling',
                price: 1200,
                seller: 'å¾·åœ‹æ’ç•«å¸«å·¥ä½œå®¤',
                sellerType: 'student',
                location: 'æ³•è˜­å…‹ç¦',
                image: 'ğŸ“š',
                description: 'æ‰‹å·¥ç¹ªè£½æ’åœ–çš„æ ¼æ—ç«¥è©±åˆé›†ï¼Œé™é‡ç‰ˆæ”¶è—å“ã€‚',
                specifications: ['é æ•¸ï¼š300é ', 'æ’åœ–ï¼š50å¹…', 'è£è¨‚ï¼šç²¾è£'],
                materials: ['æ‰‹å·¥ç´™', 'å¤©ç„¶é¡æ–™', 'çš®é©å°é¢'],
                craftTime: '60å¤©',
                condition: 'å…¨æ–°'
            },
            {
                id: 'item-10',
                title: 'ä¸­åœ‹å‚³çµ±è©•æ›¸é“å…·å¥—è£',
                category: 'storytelling',
                price: 420,
                seller: 'èªªæ›¸äººå‚³ç¿’æ‰€',
                sellerType: 'master',
                location: 'å±±è¥¿',
                image: 'ğŸ­',
                description: 'å‚³çµ±è©•æ›¸è¡¨æ¼”ç”¨å…·ï¼ŒåŒ…å«é©šå ‚æœ¨ã€æ‘ºæ‰‡ç­‰é“å…·ã€‚',
                specifications: ['ä»¶æ•¸ï¼š5ä»¶', 'æè³ªï¼šæœ¨è³ª', 'é¢¨æ ¼ï¼šå‚³çµ±'],
                materials: ['æª€æœ¨', 'ç«¹æ‰‡éª¨', 'çµ¹å¸ƒ'],
                craftTime: '10å¤©',
                condition: 'å…¨æ–°'
            },
            // æ­¦è¡“ç›¸é—œ
            {
                id: 'item-11',
                title: 'æ‰‹å·¥å¤ªæ¥µåŠ',
                category: 'martial-arts',
                price: 3600,
                seller: 'æº«ç¸£å¤ªæ¥µä¸–å®¶',
                sellerType: 'master',
                location: 'æ²³å—æº«ç¸£',
                image: 'ğŸ¥‹',
                description: 'å‚³çµ±å·¥è—æ‰“é€ çš„å¤ªæ¥µåŠï¼ŒåŠèº«æŸ”éŸŒï¼Œé©åˆå¤ªæ¥µåŠç·´ç¿’ã€‚',
                specifications: ['é•·åº¦ï¼š90cm', 'é‡é‡ï¼š500g', 'æè³ªï¼šå½ˆç°§é‹¼'],
                materials: ['å„ªè³ªé‹¼æ', 'æª€æœ¨åŠæŸ„', 'çµ²ç¶¢åŠç©—'],
                craftTime: '25å¤©',
                condition: 'å…¨æ–°',
                featured: true
            },
            {
                id: 'item-12',
                title: 'æ²–ç¹©ç©ºæ‰‹é“è¨“ç·´ç”¨å…·çµ„',
                category: 'martial-arts',
                price: 890,
                seller: 'æ²–ç¹©æ­¦é“é¤¨',
                sellerType: 'student',
                location: 'æ²–ç¹©',
                image: 'ğŸ¥Š',
                description: 'å‚³çµ±ç©ºæ‰‹é“è¨“ç·´å™¨å…·ï¼ŒåŒ…å«æœ¨äººæ¨ã€æ²™è¢‹ç­‰ã€‚',
                specifications: ['ä»¶æ•¸ï¼š3ä»¶', 'æè³ªï¼šæ©¡æœ¨', 'å°ºå¯¸ï¼šæ¨™æº–è¦æ ¼'],
                materials: ['æ©¡æœ¨', 'é»ƒæ²™', 'å¸†å¸ƒ'],
                craftTime: '8å¤©',
                condition: 'å…¨æ–°'
            }
        ];

        // é¡¯ç¤ºå·¥è—å¸‚é›†
        function showMarketplace() {
            // éš±è—æ‰€æœ‰å…¶ä»–ç•«é¢
            document.getElementById('welcomeScreen').classList.add('hidden');
            document.getElementById('courseScreen').classList.add('hidden');
            document.getElementById('learningScreen').classList.add('hidden');
            document.getElementById('completionScreen').classList.add('hidden');
            
            // é¡¯ç¤ºå¸‚é›†ç•«é¢
            showMarketplaceScreen();
        }

        function showMarketplaceScreen() {
            const main = document.querySelector('main');
            main.innerHTML = `
                <div id="marketplaceScreen">
                    <!-- å¸‚é›†é ­éƒ¨ -->
                    <div class="mb-8">
                        <div class="flex items-center justify-between mb-6">
                            <div>
                                <h2 class="text-3xl font-bold text-gray-900 dark:text-white">ğŸ›’ å·¥è—å¸‚é›†</h2>
                                <p class="text-gray-600 dark:text-gray-300 mt-2">ç™¼ç¾ä¸¦è³¼è²·ä¾†è‡ªå¸«çˆ¶å’Œå­¸å¾’çš„ç²¾ç¾æ‰‹å·¥ä½œå“</p>
                            </div>
                            <div class="flex space-x-3">
                                ${userProgress.completedCourses.length > 0 ? `
                                    <button onclick="showSellForm()" 
                                            class="bg-heritage-gold hover:bg-yellow-600 text-white px-4 py-2 rounded-lg font-semibold transition-all duration-300 text-base">
                                        ğŸ’° æˆ‘è¦è²©å”®
                                    </button>
                                ` : ''}
                                <button onclick="backToHome()" 
                                        class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg font-semibold transition-all duration-300 text-base">
                                    ğŸ  è¿”å›é¦–é 
                                </button>
                            </div>
                        </div>
                        
                        <!-- ç¯©é¸å’Œæœå°‹ -->
                        <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-4">
                            <div class="flex flex-wrap gap-4 items-center">
                                <div class="flex-1 min-w-64">
                                    <input type="text" id="searchInput" placeholder="æœå°‹å•†å“åç¨±æˆ–æè¿°..." 
                                           class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-base bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                                </div>
                                <div class="flex space-x-2">
                                    <select id="categoryFilter" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-base bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                                        <option value="">æ‰€æœ‰åˆ†é¡</option>
                                        <option value="traditional-crafts">å‚³çµ±æ‰‹å·¥è—</option>
                                        <option value="folk-music">æ°‘æ—éŸ³æ¨‚</option>
                                        <option value="festivals">å‚³çµ±ç¯€æ…¶</option>
                                        <option value="culinary-arts">çƒ¹é£ªè—è¡“</option>
                                        <option value="storytelling">å£è¿°å‚³çµ±</option>
                                        <option value="martial-arts">æ­¦è¡“å‚³çµ±</option>
                                    </select>
                                    <select id="priceFilter" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-base bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                                        <option value="">åƒ¹æ ¼ç¯„åœ</option>
                                        <option value="0-500">NT$ 0 - 500</option>
                                        <option value="500-1000">NT$ 500 - 1,000</option>
                                        <option value="1000-3000">NT$ 1,000 - 3,000</option>
                                        <option value="3000+">NT$ 3,000+</option>
                                    </select>
                                    <select id="sellerFilter" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-base bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                                        <option value="">æ‰€æœ‰è³£å®¶</option>
                                        <option value="master">å¸«çˆ¶ä½œå“</option>
                                        <option value="student">å­¸å¾’ä½œå“</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ç²¾é¸å•†å“ -->
                    <div class="mb-8">
                        <h3 class="text-2xl font-bold mb-4">â­ ç²¾é¸å•†å“</h3>
                        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6" id="featuredItems">
                            <!-- ç²¾é¸å•†å“å°‡ç”±JavaScriptç”Ÿæˆ -->
                        </div>
                    </div>

                    <!-- æ‰€æœ‰å•†å“ -->
                    <div>
                        <h3 class="text-2xl font-bold mb-4">ğŸ¨ æ‰€æœ‰å•†å“</h3>
                        <div class="grid md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6" id="allItems">
                            <!-- æ‰€æœ‰å•†å“å°‡ç”±JavaScriptç”Ÿæˆ -->
                        </div>
                    </div>
                </div>
            `;

            generateMarketplaceItems();
            setupMarketplaceFilters();
        }

        function generateMarketplaceItems() {
            // ç”Ÿæˆç²¾é¸å•†å“
            const featuredItems = marketplaceItems.filter(item => item.featured);
            const featuredContainer = document.getElementById('featuredItems');
            if (featuredContainer) {
                featuredContainer.innerHTML = featuredItems.map(item => createItemCard(item, true)).join('');
            }

            // ç”Ÿæˆæ‰€æœ‰å•†å“
            const allContainer = document.getElementById('allItems');
            if (allContainer) {
                allContainer.innerHTML = marketplaceItems.map(item => createItemCard(item, false)).join('');
            }
        }

        function createItemCard(item, isFeatured = false) {
            const categoryInfo = courses.find(c => c.id === item.category);
            const sellerBadge = item.sellerType === 'master' ? 
                '<span class="px-2 py-1 bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-300 text-xs rounded-full">å¸«çˆ¶ä½œå“</span>' :
                '<span class="px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 text-xs rounded-full">å­¸å¾’ä½œå“</span>';

            return `
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 cursor-pointer ${isFeatured ? 'ring-2 ring-heritage-gold' : ''}"
                     onclick="showItemDetails('${item.id}')">
                    ${isFeatured ? '<div class="bg-heritage-gold text-white text-center py-1 text-xs font-bold">ç²¾é¸å•†å“</div>' : ''}
                    
                    <div class="p-4">
                        <div class="flex items-start justify-between mb-3">
                            <div class="text-4xl">${item.image}</div>
                            <div class="text-right">
                                <div class="text-lg font-bold text-primary">NT$ ${item.price.toLocaleString()}</div>
                                <div class="text-xs text-gray-500 dark:text-gray-400">${item.location}</div>
                            </div>
                        </div>
                        
                        <h4 class="text-lg font-bold text-gray-900 dark:text-white mb-2 line-clamp-2">${item.title}</h4>
                        
                        <p class="text-sm text-gray-600 dark:text-gray-300 mb-3 line-clamp-2">${item.description}</p>
                        
                        <div class="flex items-center justify-between mb-3">
                            <span class="px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 text-xs rounded-full">
                                ${categoryInfo ? categoryInfo.icon + ' ' + categoryInfo.title : ''}
                            </span>
                            ${sellerBadge}
                        </div>
                        
                        <div class="text-sm text-gray-600 dark:text-gray-300">
                            <div class="flex items-center justify-between">
                                <span>è³£å®¶ï¼š${item.seller}</span>
                                <span>è£½ä½œï¼š${item.craftTime}</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function setupMarketplaceFilters() {
            const searchInput = document.getElementById('searchInput');
            const categoryFilter = document.getElementById('categoryFilter');
            const priceFilter = document.getElementById('priceFilter');
            const sellerFilter = document.getElementById('sellerFilter');

            const applyFilters = () => {
                let filteredItems = [...marketplaceItems];

                // æœå°‹éæ¿¾
                const searchTerm = searchInput.value.toLowerCase();
                if (searchTerm) {
                    filteredItems = filteredItems.filter(item => 
                        item.title.toLowerCase().includes(searchTerm) || 
                        item.description.toLowerCase().includes(searchTerm) ||
                        item.seller.toLowerCase().includes(searchTerm)
                    );
                }

                // åˆ†é¡éæ¿¾
                const category = categoryFilter.value;
                if (category) {
                    filteredItems = filteredItems.filter(item => item.category === category);
                }

                // åƒ¹æ ¼éæ¿¾
                const priceRange = priceFilter.value;
                if (priceRange) {
                    if (priceRange === '0-500') {
                        filteredItems = filteredItems.filter(item => item.price <= 500);
                    } else if (priceRange === '500-1000') {
                        filteredItems = filteredItems.filter(item => item.price > 500 && item.price <= 1000);
                    } else if (priceRange === '1000-3000') {
                        filteredItems = filteredItems.filter(item => item.price > 1000 && item.price <= 3000);
                    } else if (priceRange === '3000+') {
                        filteredItems = filteredItems.filter(item => item.price > 3000);
                    }
                }

                // è³£å®¶é¡å‹éæ¿¾
                const sellerType = sellerFilter.value;
                if (sellerType) {
                    filteredItems = filteredItems.filter(item => item.sellerType === sellerType);
                }

                // æ›´æ–°é¡¯ç¤º
                const allContainer = document.getElementById('allItems');
                if (allContainer) {
                    allContainer.innerHTML = filteredItems.map(item => createItemCard(item, false)).join('');
                }
            };

            // æ·»åŠ äº‹ä»¶ç›£è½å™¨
            searchInput.addEventListener('input', applyFilters);
            categoryFilter.addEventListener('change', applyFilters);
            priceFilter.addEventListener('change', applyFilters);
            sellerFilter.addEventListener('change', applyFilters);
        }

        function showItemDetails(itemId) {
            const item = marketplaceItems.find(i => i.id === itemId);
            if (!item) return;

            const categoryInfo = courses.find(c => c.id === item.category);
            const modal = document.getElementById('customModal');
            const content = document.getElementById('modalContent');

            content.innerHTML = `
                <div class="max-w-3xl">
                    <div class="flex items-start space-x-6 mb-6">
                        <div class="text-6xl">${item.image}</div>
                        <div class="flex-1">
                            <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-2">${item.title}</h3>
                            <div class="flex items-center space-x-3 mb-3">
                                <span class="px-3 py-1 ${categoryInfo.color.replace('bg-', 'bg-opacity-20 bg-')} ${categoryInfo.color.replace('bg-', 'text-')} rounded-full text-sm">
                                    ${categoryInfo.icon} ${categoryInfo.title}
                                </span>
                                <span class="px-3 py-1 ${item.sellerType === 'master' ? 'bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-300' : 'bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300'} rounded-full text-sm">
                                    ${item.sellerType === 'master' ? 'å¸«çˆ¶ä½œå“' : 'å­¸å¾’ä½œå“'}
                                </span>
                            </div>
                            <div class="text-3xl font-bold text-primary mb-2">NT$ ${item.price.toLocaleString()}</div>
                            <div class="text-gray-600 dark:text-gray-300">
                                <div class="flex items-center space-x-4 text-sm">
                                    <span>ğŸ“ ${item.location}</span>
                                    <span>ğŸ› ï¸ ${item.craftTime}</span>
                                    <span>âœ¨ ${item.condition}</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="space-y-4 mb-6">
                        <div>
                            <h4 class="font-bold text-gray-900 dark:text-white mb-2">ğŸ“ å•†å“æè¿°</h4>
                            <p class="text-gray-700 dark:text-gray-300 text-sm leading-relaxed">${item.description}</p>
                        </div>

                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <h4 class="font-bold text-gray-900 dark:text-white mb-2">ğŸ“ è¦æ ¼èªªæ˜</h4>
                                <ul class="space-y-1">
                                    ${item.specifications.map(spec => 
                                        `<li class="text-gray-700 dark:text-gray-300 text-sm">â€¢ ${spec}</li>`
                                    ).join('')}
                                </ul>
                            </div>
                            <div>
                                <h4 class="font-bold text-gray-900 dark:text-white mb-2">ğŸ¨ ææ–™å·¥è—</h4>
                                <div class="flex flex-wrap gap-2">
                                    ${item.materials.map(material => 
                                        `<span class="px-2 py-1 bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 text-xs rounded-full">${material}</span>`
                                    ).join('')}
                                </div>
                            </div>
                        </div>

                        <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
                            <h4 class="font-bold text-gray-900 dark:text-white mb-2">ğŸ‘¤ è³£å®¶è³‡è¨Š</h4>
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="font-medium text-gray-900 dark:text-white">${item.seller}</div>
                                    <div class="text-sm text-gray-600 dark:text-gray-300">ä¾†è‡ª ${item.location}</div>
                                </div>
                                <button onclick="contactSeller('${item.id}')" 
                                        class="bg-primary hover:bg-purple-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-all duration-300">
                                    ğŸ’¬ è¯ç¹«è³£å®¶
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="flex justify-center space-x-3">
                        <button onclick="closeModal()" 
                                class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-300">
                            é—œé–‰
                        </button>
                        <button onclick="purchaseItem('${item.id}')" 
                                class="bg-heritage-gold hover:bg-yellow-600 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-300">
                            ğŸ›’ æˆ‘è¦è³¼è²·
                        </button>
                    </div>
                </div>
            `;

            modal.classList.remove('hidden');
        }

        function contactSeller(itemId) {
            const item = marketplaceItems.find(i => i.id === itemId);
            if (!item) return;

            const subject = encodeURIComponent(`é—œæ–¼æ‚¨çš„å•†å“ã€Œ${item.title}ã€è©¢å•`);
            const body = encodeURIComponent(`æ‚¨å¥½ï¼Œ

æˆ‘åœ¨æ–‡åŒ–å‚³æ‰¿å­¸é™¢å·¥è—å¸‚é›†çœ‹åˆ°æ‚¨çš„å•†å“ã€Œ${item.title}ã€ï¼Œå°æ­¤å¾ˆæ„Ÿèˆˆè¶£ã€‚

å¸Œæœ›èƒ½é€²ä¸€æ­¥äº†è§£ï¼š
1. å•†å“çš„è©³ç´°æƒ…æ³
2. è³¼è²·å’Œäº¤ä»˜æ–¹å¼
3. æ˜¯å¦é‚„æœ‰å…¶ä»–é¡ä¼¼ä½œå“

æœŸå¾…æ‚¨çš„å›è¦†ï¼Œè¬è¬ï¼

æ­¤è‡´
æ•¬ç¦®

${userProgress.userName || 'å¸‚é›†è¨ªå®¢'}
ä¾†è‡ªæ–‡åŒ–å‚³æ‰¿å­¸é™¢å·¥è—å¸‚é›†`);

            const mailtoLink = `mailto:seller@heritage-market.com?subject=${subject}&body=${body}`;
            window.open(mailtoLink);
        }

        function purchaseItem(itemId) {
            const item = marketplaceItems.find(i => i.id === itemId);
            if (!item) return;

            closeModal();
            
            setTimeout(() => {
                showCustomModal('è³¼è²·ç¢ºèª', `æ‚¨ç¢ºå®šè¦è³¼è²·ã€Œ${item.title}ã€å—ï¼Ÿ\nåƒ¹æ ¼ï¼šNT$ ${item.price.toLocaleString()}\n\nè«‹æ³¨æ„ï¼šé€™æ˜¯ç¤ºç¯„åŠŸèƒ½ï¼Œå¯¦éš›è³¼è²·éœ€è¦å®Œæ•´çš„æ”¯ä»˜ç³»çµ±ã€‚`, () => {
                    showCustomModal('è³¼è²·æˆåŠŸ', `æ­å–œæ‚¨æˆåŠŸè³¼è²·ã€Œ${item.title}ã€ï¼\n\nè³£å®¶å°‡æœƒç›¡å¿«èˆ‡æ‚¨è¯ç¹«å®‰æ’äº¤ä»˜äº‹å®œã€‚æ„Ÿè¬æ‚¨æ”¯æŒå‚³çµ±å·¥è—æ–‡åŒ–ï¼`, null);
                });
            }, 100);
        }

        function showSellForm() {
            const modal = document.getElementById('customModal');
            const content = document.getElementById('modalContent');

            content.innerHTML = `
                <div class="max-w-2xl">
                    <h3 class="text-2xl font-bold mb-6 text-center">ğŸ’° ä¸Šæ¶æ‚¨çš„ä½œå“</h3>
                    <p class="text-gray-600 dark:text-gray-300 mb-6 text-center">
                        å®Œæˆèª²ç¨‹çš„å­¸ç¿’è€…å¯ä»¥åœ¨å¸‚é›†ä¸Šè²©å”®è‡ªå·±çš„æ‰‹å·¥ä½œå“
                    </p>

                    <form id="sellForm" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">å•†å“åç¨±</label>
                            <input type="text" id="sellTitle" placeholder="ç‚ºæ‚¨çš„ä½œå“å–å€‹å¥½åå­—..." 
                                   class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-base bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">ä½œå“åˆ†é¡</label>
                            <select id="sellCategory" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-base bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                                <option value="">è«‹é¸æ“‡åˆ†é¡</option>
                                ${userProgress.completedCourses.map(courseId => {
                                    const course = courses.find(c => c.id === courseId);
                                    return `<option value="${courseId}">${course.icon} ${course.title}</option>`;
                                }).join('')}
                            </select>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">å”®åƒ¹ (NT$)</label>
                            <input type="number" id="sellPrice" placeholder="è¨­å®šæ‚¨çš„å”®åƒ¹..." min="1"
                                   class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-base bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">ä½œå“æè¿°</label>
                            <textarea id="sellDescription" rows="4" placeholder="è©³ç´°æè¿°æ‚¨çš„ä½œå“ï¼ŒåŒ…æ‹¬è£½ä½œéç¨‹ã€ææ–™ã€ç‰¹è‰²ç­‰..."
                                      class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-base bg-white dark:bg-gray-700 text-gray-900 dark:text-white"></textarea>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">è£½ä½œæ™‚é–“</label>
                            <input type="text" id="sellCraftTime" placeholder="ä¾‹å¦‚ï¼š7å¤©ã€2é€±ã€1å€‹æœˆ..."
                                   class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-base bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">æ‰€åœ¨åœ°å€</label>
                            <input type="text" id="sellLocation" placeholder="æ‚¨çš„æ‰€åœ¨åŸå¸‚..."
                                   class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-base bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                        </div>
                    </form>

                    <div class="mt-6 flex justify-center space-x-3">
                        <button onclick="closeModal()" 
                                class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-300">
                            å–æ¶ˆ
                        </button>
                        <button onclick="submitSellForm()" 
                                class="bg-heritage-gold hover:bg-yellow-600 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-300">
                            ä¸Šæ¶å•†å“
                        </button>
                    </div>
                </div>
            `;

            modal.classList.remove('hidden');
        }

        function submitSellForm() {
            const title = document.getElementById('sellTitle').value.trim();
            const category = document.getElementById('sellCategory').value;
            const price = document.getElementById('sellPrice').value;
            const description = document.getElementById('sellDescription').value.trim();
            const craftTime = document.getElementById('sellCraftTime').value.trim();
            const location = document.getElementById('sellLocation').value.trim();

            if (!title || !category || !price || !description || !craftTime || !location) {
                showCustomModal('éŒ¯èª¤', 'è«‹å¡«å¯«æ‰€æœ‰å¿…è¦æ¬„ä½ã€‚', null);
                return;
            }

            closeModal();
            
            setTimeout(() => {
                showCustomModal('ä¸Šæ¶æˆåŠŸ', `æ­å–œï¼æ‚¨çš„ä½œå“ã€Œ${title}ã€å·²æˆåŠŸä¸Šæ¶åˆ°å·¥è—å¸‚é›†ã€‚\n\næˆ‘å€‘æœƒå„˜å¿«å¯©æ ¸æ‚¨çš„å•†å“ï¼Œå¯©æ ¸é€šéå¾Œå°‡é¡¯ç¤ºåœ¨å¸‚é›†ä¸­ã€‚æ„Ÿè¬æ‚¨åˆ†äº«æ‚¨çš„ç²¾ç¾ä½œå“ï¼`, null);
            }, 100);
        }

        function backToHome() {
            // é‡æ–°è¼‰å…¥ä¸»é é¢
            location.reload();
        }

        // åˆå§‹åŒ–
        updateUI();
    </script>


</body></html>
